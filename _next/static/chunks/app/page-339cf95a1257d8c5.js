(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{600:(e,t,n)=>{Promise.resolve().then(n.bind(n,4533))},4533:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>L});var s=n(5155),a=n(2115);let r=(0,a.createContext)(void 0);function i(e){let{children:t}=e,[n,i]=(0,a.useState)("week"),[l,o]=(0,a.useState)("2025-07-22"),[d,c]=(0,a.useState)("2025-09-06"),[u,m]=(0,a.useState)(25e3),[h,g]=(0,a.useState)(2e4),[p,x]=(0,a.useState)(0),[f,v]=(0,a.useState)(0),[y,j]=(0,a.useState)("no"),[b,w]=(0,a.useState)(75),[S,F]=(0,a.useState)(20),[C,D]=(0,a.useState)(10),[P,N]=(0,a.useState)("yes"),[z,T]=(0,a.useState)(2),[k,R]=(0,a.useState)(0),[E,I]=(0,a.useState)("no"),[_,A]=(0,a.useState)(0);return(0,s.jsx)(r.Provider,{value:{view:n,winStart:l,winEnd:d,walletSize:u,realizedProfit:h,moonbagReal:p,moonbagUnreal:f,includeUnreal:y,moonbagFounderPct:b,mgmtFeePct:S,entryFeePct:C,feeReducesInvestor:P,founderCount:z,drawPerFounder:k,applyDraws:E,domLeadPct:_,setView:i,setWinStart:o,setWinEnd:c,setWalletSize:m,setRealizedProfit:g,setMoonbagReal:x,setMoonbagUnreal:v,setIncludeUnreal:j,setMoonbagFounderPct:w,setMgmtFeePct:F,setEntryFeePct:D,setFeeReducesInvestor:N,setFounderCount:T,setDrawPerFounder:R,setApplyDraws:I,setDomLeadPct:A},children:t})}function l(){let e=(0,a.useContext)(r);if(!e)throw Error("useCalculator must be used within CalculatorProvider");return e}var o=n(5239);function d(){l();let[e,t]=(0,a.useState)(!0),[n,r]=(0,a.useState)(""),[i,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(""),m=(0,a.useRef)(null),[h,g]=(0,a.useState)(""),[p,x]=(0,a.useState)(null),f=async()=>{if(i)try{(await fetch("/api/save-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis:i})})).ok?u("Analysis saved successfully"):u("Failed to save analysis")}catch(e){console.error("Save analysis error",e),u("Failed to save analysis")}finally{d(null),m.current&&(m.current.value="")}};return(0,s.jsxs)("div",{className:"status",children:[(0,s.jsx)("span",{className:"dot ok"}),(0,s.jsx)("b",{children:"Calculator ready."}),(0,s.jsx)("span",{id:"seedMsg",className:"small",children:"Seeding defaults…"}),(0,s.jsx)("button",{className:"btn",onClick:()=>{console.log("Reseed defaults")},children:"Force re-seed"}),(0,s.jsx)("button",{className:"btn",onClick:()=>{let e=performance.now();console.log("Recalculate");let t=performance.now();r("Calculated in ".concat((t-e).toFixed(2)," ms"))},children:"Recalculate"}),(0,s.jsx)("button",{className:"btn",onClick:()=>{console.log("Self-Test")},children:"Self-Test"}),(0,s.jsxs)("label",{className:"small",children:[(0,s.jsx)("input",{type:"checkbox",checked:e,onChange:e=>t(e.target.checked)})," ","Auto-save on Recalculate"]}),(0,s.jsx)("button",{className:"btn",onClick:()=>{console.log("Save snapshot")},children:"Save snapshot now"}),(0,s.jsx)("input",{type:"file",accept:"image/*",ref:m,style:{display:"none"},onChange:e=>{var t;let n=null==(t=e.target.files)?void 0:t[0];if(n){console.log("Uploaded screenshot",n.name),g("Processing...");let e=new FormData;e.append("file",n),fetch("/api/ocr",{method:"POST",body:e}).then(async e=>{let t=await e.json();if(!e.ok){g("OCR error: ".concat((null==t?void 0:t.error)||e.statusText)),console.error("OCR error",t);return}g(t.text||t.error||"No text recognized"),t.processed_png_base64?x("data:image/png;base64,".concat(t.processed_png_base64)):x(null)}).catch(e=>{console.error("OCR request failed",e),g("OCR request failed")})}}}),(0,s.jsx)("button",{className:"btn",onClick:()=>{var e;null==(e=m.current)||e.click()},children:"Upload Screenshot"}),h&&(0,s.jsxs)("div",{className:"small",style:{marginLeft:"12px"},id:"ocrResult",children:[(0,s.jsx)("b",{children:"OCR:"})," ",h," ",(0,s.jsx)("button",{className:"btn",onClick:()=>{var e;return null==(e=navigator.clipboard)?void 0:e.writeText(h)},title:"Copy OCR text",children:"Copy"}),p&&(0,s.jsx)("a",{className:"btn",href:p,download:"processed.png",style:{marginLeft:"8px"},children:"Download Processed Image"})]}),p&&(0,s.jsx)(o.default,{id:"ocrCanvas",src:p,alt:"processed",width:160,height:120,style:{marginLeft:12,borderRadius:6}}),(0,s.jsx)("span",{className:"small",children:n}),i&&(0,s.jsxs)("div",{className:"analysis-preview",children:[(0,s.jsx)("pre",{children:JSON.stringify(i,null,2)}),(0,s.jsx)("button",{className:"btn",onClick:f,children:"Save Analysis"})]}),c&&(0,s.jsx)("span",{className:"small",children:c})]})}let c=[{key:"calc",label:"Calculator"},{key:"history",label:"History"},{key:"charts",label:"Charts"},{key:"audit",label:"Founders Audit"},{key:"assistant",label:"AI Assistant"}];function u(e){let{active:t,onChange:n}=e;return(0,s.jsx)("div",{className:"tabs",children:c.map(e=>(0,s.jsx)("div",{className:"tab ".concat(t===e.key?"active":""),onClick:()=>n(e.key),children:e.label},e.key))})}function m(){let{realizedProfit:e,setRealizedProfit:t,moonbagReal:n,setMoonbagReal:a,moonbagUnreal:r,setMoonbagUnreal:i,includeUnreal:o,setIncludeUnreal:d,moonbagFounderPct:c,setMoonbagFounderPct:u,mgmtFeePct:m,setMgmtFeePct:h,entryFeePct:g,setEntryFeePct:p,feeReducesInvestor:x,setFeeReducesInvestor:f,founderCount:v,setFounderCount:y,drawPerFounder:j,setDrawPerFounder:b,applyDraws:w,setApplyDraws:S,domLeadPct:F,setDomLeadPct:C}=l();return(0,s.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"repeat(12,1fr)",gap:"12px",marginTop:"16px"},children:[(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Realized profit this period (if wallet size = 0) ($)"}),(0,s.jsx)("input",{type:"number",step:"0.01",value:e,onChange:e=>t(parseFloat(e.target.value)||0)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsxs)("label",{children:["Moonbag ",(0,s.jsx)("b",{children:"realized"})," this period ($)"]}),(0,s.jsx)("input",{type:"number",step:"0.01",value:n,onChange:e=>a(parseFloat(e.target.value)||0)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsxs)("label",{children:["Moonbag ",(0,s.jsx)("b",{children:"unrealized"})," (valuation change) ($)"]}),(0,s.jsx)("input",{type:"number",step:"0.01",value:r,onChange:e=>i(parseFloat(e.target.value)||0)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsxs)("label",{children:["Include ",(0,s.jsx)("b",{children:"unrealized"})," in Wallet identity?"]}),(0,s.jsxs)("select",{value:o,onChange:e=>d(e.target.value),children:[(0,s.jsx)("option",{value:"no",children:"No — track only"}),(0,s.jsx)("option",{value:"yes",children:"Yes — include in identity"})]})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Moonbag founders share (%)"}),(0,s.jsx)("input",{type:"number",step:"0.1",value:c,onChange:e=>u(parseFloat(e.target.value)||0)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Regular fund fee on investor base profit (%) → Founders"}),(0,s.jsx)("input",{type:"number",step:"0.1",value:m,onChange:e=>h(parseFloat(e.target.value)||0)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Entry fee on new investor capital (%) → Founders"}),(0,s.jsx)("input",{type:"number",step:"0.1",value:g,onChange:e=>p(parseFloat(e.target.value)||0)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Entry fee reduces investor credited capital?"}),(0,s.jsxs)("select",{value:x,onChange:e=>f(e.target.value),children:[(0,s.jsx)("option",{value:"yes",children:"Yes (net = gross \xd7 (1−fee))"}),(0,s.jsx)("option",{value:"no",children:"No (investor credited full; fee outside)"})]})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 2"},children:[(0,s.jsx)("label",{children:"Founders — count"}),(0,s.jsx)("input",{type:"number",min:"1",step:"1",value:v,onChange:e=>y(parseInt(e.target.value)||0)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 2"},children:[(0,s.jsx)("label",{children:"Weekly draw per founder ($)"}),(0,s.jsx)("input",{type:"number",step:"1",value:j,onChange:e=>b(parseFloat(e.target.value)||0)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Apply founders’ draws in this period?"}),(0,s.jsxs)("select",{value:w,onChange:e=>S(e.target.value),children:[(0,s.jsx)("option",{value:"no",children:"No"}),(0,s.jsx)("option",{value:"yes",children:"Yes"})]})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Dominance lead margin (%) over largest investor"}),(0,s.jsx)("input",{type:"number",step:"0.1",value:F,onChange:e=>C(parseFloat(e.target.value)||0)})]})]})}function h(){let{view:e,setView:t,winStart:n,setWinStart:a,winEnd:r,setWinEnd:i,walletSize:o,setWalletSize:d}=l();return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"Allocation Settings"}),(0,s.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"repeat(12,1fr)",gap:"12px"},children:[(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"View"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{id:"viewWeek",className:"btn ".concat("week"===e?"activeBtn":""),onClick:()=>t("week"),children:"Week"}),(0,s.jsx)("button",{id:"viewMax",className:"btn ".concat("max"===e?"activeBtn":""),onClick:()=>t("max"),children:"Max"})]})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Allocation window — Start (inclusive)"}),(0,s.jsx)("input",{id:"winStart",type:"date",value:n,onChange:e=>a(e.target.value)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Allocation window — End (inclusive)"}),(0,s.jsx)("input",{id:"winEnd",type:"date",value:r,onChange:e=>i(e.target.value)})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 3"},children:[(0,s.jsx)("label",{children:"Total Wallet Size at End of Window ($)"}),(0,s.jsx)("input",{id:"walletSize",type:"number",step:"0.01",value:o,onChange:e=>d(parseFloat(e.target.value)||0)})]})]}),(0,s.jsx)(m,{})]})}let g=[{name:"Laura",date:"2025-07-22",amount:"5000",rule:"net",cls:"investor"},{name:"Laura",date:"2025-07-31",amount:"5000",rule:"net",cls:"investor"},{name:"Laura",date:"2025-08-25",amount:"2500",rule:"net",cls:"investor"},{name:"Laura",date:"2025-09-06",amount:"2500",rule:"net",cls:"investor"},{name:"Damon",date:"2025-08-02",amount:"5000",rule:"net",cls:"investor"}];function p(){let[e,t]=(0,a.useState)([{name:"Founders",date:"2025-07-10",amount:"5000",rule:"net",cls:"founder"},...g.map(e=>({name:e.name,date:e.date,amount:String(e.amount),rule:e.rule||"net",cls:e.cls||"investor"}))]),n=l(),r=(0,a.useCallback)(async e=>{t(e.map((e,t)=>({name:e.name||"Investor ".concat(t+1),date:e.date,amount:String(e.amount),rule:e.rule||"net",cls:e.cls||"investor"})));let s=e.reduce((e,t)=>e+(Number(t.amount)||0),0);n.setRealizedProfit(s)},[n]);a.useEffect(()=>(window.populateInvestorsFromAI=r,window.getInvestorData=()=>e,()=>{delete window.populateInvestorsFromAI,delete window.getInvestorData}),[r,e]);let i=(n,s,a)=>{let r=[...e];r[n][s]=a,t(r)};return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"Founders & Investors"}),(0,s.jsx)("div",{className:"tablewrap",children:(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{style:{width:"14%"},children:"Investor"}),(0,s.jsx)("th",{style:{width:"12%"},children:"Class"}),(0,s.jsx)("th",{style:{width:"18%"},children:"Date"}),(0,s.jsx)("th",{style:{width:"18%"},children:"Amount ($)"}),(0,s.jsx)("th",{style:{width:"18%"},children:"Gross→Net rule"}),(0,s.jsx)("th",{children:"Action"})]})}),(0,s.jsx)("tbody",{children:e.map((n,a)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"text",value:n.name,onChange:e=>i(a,"name",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsxs)("select",{value:n.cls||"investor",onChange:e=>i(a,"cls",e.target.value),children:[(0,s.jsx)("option",{value:"founder",children:"founder"}),(0,s.jsx)("option",{value:"investor",children:"investor"})]})}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"date",value:n.date,onChange:e=>i(a,"date",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"number",step:"0.01",value:n.amount,onChange:e=>i(a,"amount",e.target.value)})}),(0,s.jsx)("td",{children:(0,s.jsxs)("select",{value:n.rule,onChange:e=>i(a,"rule",e.target.value),children:[(0,s.jsx)("option",{value:"net",children:"Net of fee"}),(0,s.jsx)("option",{value:"gross",children:"Fee outside"})]})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"x",onClick:()=>{t(e.filter((e,t)=>t!==a))},children:"Remove"})})]},a))}),(0,s.jsx)("tfoot",{children:(0,s.jsx)("tr",{children:(0,s.jsxs)("td",{colSpan:5,children:[(0,s.jsx)("button",{className:"btn",onClick:()=>t([...e,{name:"",date:"",amount:"",rule:"net"}]),children:"+ Add investor"}),(0,s.jsx)("button",{className:"btn",onClick:()=>{t([{name:"Founders",date:"2025-07-10",amount:"5000",rule:"net",cls:"founder"},...g.map(e=>({name:e.name,date:e.date,amount:String(e.amount),rule:e.rule||"net",cls:e.cls||"investor"}))]);let e=g.reduce((e,t)=>e+(Number(t.amount)||0),0);n.setRealizedProfit(e)},style:{marginLeft:8},children:"Load baseline"}),(0,s.jsx)("button",{className:"btn",onClick:()=>{t([])},style:{marginLeft:8},children:"Clear"}),(0,s.jsx)("button",{className:"btn",onClick:()=>{r([{name:"Founders",date:"2025-07-10",amount:5e3,rule:"net",cls:"founder"},{name:"Laura",date:"2025-07-22",amount:5e3,rule:"net",cls:"investor"},{name:"Laura",date:"2025-07-31",amount:5e3,rule:"net",cls:"investor"},{name:"Laura",date:"2025-08-25",amount:2500,rule:"net",cls:"investor"},{name:"Laura",date:"2025-09-06",amount:2500,rule:"net",cls:"investor"},{name:"Damon",date:"2025-08-02",amount:5e3,rule:"net",cls:"investor"}])},style:{marginLeft:8,backgroundColor:"#4CAF50",color:"white"},children:"\uD83E\uDD16 AI Populate (Complete Data)"})]})})})]})}),(0,s.jsx)("div",{className:"small",id:"presetNote",children:"Preset: example investors; fees placeholders."})]})}function x(){return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"Audit — Row Classification"}),(0,s.jsx)("div",{className:"small muted",children:"Row classification audit placeholder"})]})}function f(){let e=l(),[t,n]=(0,a.useState)([]),[r,i]=(0,a.useState)({totalContributions:0,totalDollarDays:0,totalBaseProfitShare:0,totalFees:0,totalNetProfit:0});(0,a.useEffect)(()=>{(()=>{var t,s;let a=(null==(t=(s=window).getInvestorData)?void 0:t.call(s))||[];if(0===a.length)return n([]);let r=new Date(e.winStart),l=new Date(e.winEnd);l.getTime(),r.getTime();let o={};a.forEach(e=>{let t="".concat(e.name||"Unknown","_").concat(e.cls||"investor");o[t]||(o[t]=[]),o[t].push({name:e.name||"Unknown",date:e.date,amount:Number(e.amount)||0,rule:e.rule||"net",cls:e.cls||"investor"})});let d=[],c=0;Object.values(o).forEach(t=>{if(0===t.length)return;let n=t[0],s=0,a=0;t.forEach(e=>{let t=new Date(e.date);if(t>=r&&t<=l){let n=Math.max(0,Math.ceil((l.getTime()-t.getTime())/864e5));s+=e.amount*n,a+=e.amount}});let i=5e3*("founder"===n.cls);d.push({name:n.name,cls:n.cls,startCapital:i,contributions:a,dollarDays:s,twShare:0,baseProfitShare:0,regularFee:0,moonbag:0,draws:"founder"===n.cls?e.drawPerFounder:0,netProfit:0,pgp:0,endCapital:0}),c+=s});let u=e.realizedProfit,m=e.mgmtFeePct/100,h=e.entryFeePct/100,g=0,p=0,x=0,f=0;d.forEach(e=>{e.twShare=c>0?e.dollarDays/c*100:0,e.baseProfitShare=e.twShare/100*u});let v=d.filter(e=>"investor"===e.cls).reduce((e,t)=>e+t.baseProfitShare*m,0),y=d.filter(e=>"investor"===e.cls).reduce((e,t)=>e+t.contributions*h,0),j=d.filter(e=>"founder"===e.cls).length||e.founderCount,b=e.moonbagUnreal||0;d.forEach(t=>{"investor"===t.cls?t.regularFee=-(t.baseProfitShare*m):"founder"===t.cls&&(t.regularFee=v/Math.max(1,j));let n=0;"investor"===t.cls?(n=-(t.contributions*h),"yes"===e.feeReducesInvestor&&(t.contributions*=1-h)):"founder"===t.cls&&(n=y/Math.max(1,j)),"founder"===t.cls?t.moonbag=.75*b/Math.max(1,j):"investor"===t.cls&&(t.moonbag=.25*b*(t.twShare/100)),t.regularFee+=n,t.netProfit=t.baseProfitShare+t.regularFee+t.moonbag-t.draws,t.pgp=t.contributions>0?t.netProfit/t.contributions*100:0,t.endCapital=t.contributions+t.netProfit,g+=t.baseProfitShare,p+=t.regularFee,x+=t.netProfit,f+=t.contributions}),n(d),i({totalContributions:f,totalDollarDays:c,totalBaseProfitShare:g,totalFees:p,totalNetProfit:x})})()},[e.winStart,e.winEnd,e.realizedProfit,e.mgmtFeePct,e.entryFeePct,e.feeReducesInvestor,e.moonbagReal,e.moonbagFounderPct,e.founderCount,e.drawPerFounder]);let o=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),d=e=>"".concat(e.toFixed(1),"%");return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"Results (time-weighted)"}),(0,s.jsxs)("div",{className:"small",children:["Window: ",e.winStart," to ",e.winEnd," | Total Realized Profit: ",o(e.realizedProfit)," | Management Fee: ",e.mgmtFeePct,"% | Entry Fee: ",e.entryFeePct,"%"]}),(0,s.jsx)("div",{className:"tablewrap",children:(0,s.jsxs)("table",{style:{marginTop:"10px"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Class / Name"}),(0,s.jsx)("th",{className:"right",children:"Start-of-window capital"}),(0,s.jsx)("th",{className:"right",children:"Contribs in window"}),(0,s.jsx)("th",{className:"right",children:"Dollar-days (weight)"}),(0,s.jsx)("th",{className:"right",children:"TW Share %"}),(0,s.jsx)("th",{className:"right",children:"Base profit share"}),(0,s.jsxs)("th",{className:"right",children:["Regular fund fee (",e.mgmtFeePct,"%)"]}),(0,s.jsx)("th",{className:"right",children:"Moonbag (realized)"}),(0,s.jsx)("th",{className:"right",children:"Draws"}),(0,s.jsx)("th",{className:"right",children:"Net Profit (after fees)"}),(0,s.jsx)("th",{className:"right",children:"PGP (period %)"}),(0,s.jsx)("th",{className:"right",children:"End capital"})]})}),(0,s.jsxs)("tbody",{children:[0===t.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:12,className:"muted",children:'No investor data available. Add investors in the table above or click "Load baseline" to see results.'})}):t.map((e,t)=>(0,s.jsxs)("tr",{className:"founder"===e.cls?"founder-row":"investor-row",children:[(0,s.jsxs)("td",{children:[(0,s.jsx)("strong",{children:e.name}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"small",children:e.cls})]}),(0,s.jsx)("td",{className:"right",children:o(e.startCapital)}),(0,s.jsx)("td",{className:"right",children:o(e.contributions)}),(0,s.jsx)("td",{className:"right",children:e.dollarDays.toLocaleString()}),(0,s.jsx)("td",{className:"right",children:d(e.twShare)}),(0,s.jsx)("td",{className:"right",children:o(e.baseProfitShare)}),(0,s.jsx)("td",{className:"right",children:o(e.regularFee)}),(0,s.jsx)("td",{className:"right",children:o(e.moonbag)}),(0,s.jsx)("td",{className:"right",children:o(e.draws)}),(0,s.jsx)("td",{className:"right",children:(0,s.jsx)("strong",{children:o(e.netProfit)})}),(0,s.jsx)("td",{className:"right",children:d(e.pgp)}),(0,s.jsx)("td",{className:"right",children:o(e.endCapital)})]},t)),t.length>0&&(0,s.jsxs)("tr",{className:"total-row",style:{borderTop:"2px solid #333",fontWeight:"bold"},children:[(0,s.jsx)("td",{children:"TOTALS"}),(0,s.jsx)("td",{className:"right",children:"-"}),(0,s.jsx)("td",{className:"right",children:o(r.totalContributions)}),(0,s.jsx)("td",{className:"right",children:r.totalDollarDays.toLocaleString()}),(0,s.jsx)("td",{className:"right",children:"100.0%"}),(0,s.jsx)("td",{className:"right",children:o(r.totalBaseProfitShare)}),(0,s.jsx)("td",{className:"right",children:o(r.totalFees)}),(0,s.jsx)("td",{className:"right",children:"-"}),(0,s.jsx)("td",{className:"right",children:"-"}),(0,s.jsx)("td",{className:"right",children:(0,s.jsx)("strong",{children:o(r.totalNetProfit)})}),(0,s.jsx)("td",{className:"right",children:"-"}),(0,s.jsx)("td",{className:"right",children:"-"})]})]})]})}),(0,s.jsx)("div",{className:"small",id:"domNote",children:e.domLeadPct>0&&(0,s.jsxs)(s.Fragment,{children:["Dominant Lead Fee: ",e.domLeadPct,"% applied to calculations above."]})})]})}function v(){let e=l(),[t,n]=(0,a.useState)([]),[r,i]=(0,a.useState)(0);(0,a.useEffect)(()=>{(()=>{var t,s;let a=(null==(t=(s=window).getInvestorData)?void 0:t.call(s))||[];if(0===a.length){n([]),i(0);return}let r=new Date(e.winStart),l=new Date(e.winEnd);l.getTime(),r.getTime();let o={};a.forEach(e=>{let t="".concat(e.name||"Unknown","_").concat(e.cls||"investor");o[t]||(o[t]=[]),o[t].push(e)});let d=[],c=0;Object.values(o).forEach(e=>{if(0===e.length)return;e[0];let t=0;e.forEach(e=>{let n=new Date(e.date);if(n>=r&&n<=l){let s=Math.max(0,Math.ceil((l.getTime()-n.getTime())/864e5));t+=(Number(e.amount)||0)*s}}),c+=t}),Object.values(o).forEach(t=>{if(0===t.length)return;let n=t[0],s=0;if(t.forEach(e=>{let t=new Date(e.date);if(t>=r&&t<=l){let n=Math.max(0,Math.ceil((l.getTime()-t.getTime())/864e5));s+=(Number(e.amount)||0)*n}}),"investor"===n.cls){let t=(c>0?s/c:0)*e.realizedProfit,a=e.mgmtFeePct/100;d.push({name:n.name||"Unknown",baseProfitShare:t,feeRate:e.mgmtFeePct,feeAmount:t*a})}});let u=d.reduce((e,t)=>e+t.feeAmount,0);n(d),i(u)})()},[e.winStart,e.winEnd,e.realizedProfit,e.mgmtFeePct]);let o=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"Fee Breakdown — Investors (base profit only)"}),(0,s.jsxs)("div",{className:"small",children:["Management fees collected on base profit share at ",e.mgmtFeePct,"% rate"]}),(0,s.jsx)("div",{className:"tablewrap",children:(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Investor"}),(0,s.jsx)("th",{className:"right",children:"Base profit share"}),(0,s.jsx)("th",{className:"right",children:"Fee rate"}),(0,s.jsx)("th",{className:"right",children:"Fee amount"})]})}),(0,s.jsxs)("tbody",{children:[0===t.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"muted",children:"No investor fee data available. Add investors in the table above to see fee breakdown."})}):t.map((e,t)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("strong",{children:e.name})}),(0,s.jsx)("td",{className:"right",children:o(e.baseProfitShare)}),(0,s.jsxs)("td",{className:"right",children:[e.feeRate.toFixed(1),"%"]}),(0,s.jsx)("td",{className:"right",children:(0,s.jsx)("strong",{children:o(e.feeAmount)})})]},t)),t.length>0&&(0,s.jsxs)("tr",{style:{borderTop:"2px solid #333",fontWeight:"bold"},children:[(0,s.jsx)("td",{children:"TOTAL FEES"}),(0,s.jsx)("td",{className:"right",children:"-"}),(0,s.jsx)("td",{className:"right",children:"-"}),(0,s.jsx)("td",{className:"right",children:(0,s.jsx)("strong",{children:o(r)})})]})]})]})}),(0,s.jsx)("div",{className:"small",id:"feeNotes",children:r>0&&(0,s.jsxs)(s.Fragment,{children:["Total management fees: ",o(r)," | Fee rate: ",e.mgmtFeePct,"% of base profit share | Fees paid to founders"]})})]})}function y(){let e=l(),[t,n]=(0,a.useState)([]),[r,i]=(0,a.useState)(0);(0,a.useEffect)(()=>{(()=>{var t,s;let a=(null==(t=(s=window).getInvestorData)?void 0:t.call(s))||[];if(0===a.length){n([]),i(0);return}let r=new Date(e.winStart),l=e.entryFeePct/100,o={};a.forEach(e=>{let t="".concat(e.name||"Unknown","_").concat(e.cls||"investor");o[t]||(o[t]=[]),o[t].push(e)});let d=[];Object.values(o).forEach(e=>{if(0===e.length)return;let t=e[0],n=0,s=0;e.forEach(e=>{let t=new Date(e.date),a=(Number(e.amount)||0)*l;t<r?n+=a:s+=a});let a=n+s;a>0&&d.push({name:t.name||"Unknown",preStartFees:n,inWindowFees:s,totalFees:a})});let c=d.reduce((e,t)=>e+t.totalFees,0);n(d),i(c)})()},[e.winStart,e.entryFeePct]);let o=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsxs)("h2",{children:["Entry Fee Breakdown — Routed to Founders (",e.entryFeePct,"%)"]}),(0,s.jsxs)("div",{className:"small",children:["Entry fees charged on investor contributions at ",e.entryFeePct,"% rate, paid to founders"]}),(0,s.jsx)("div",{className:"tablewrap",children:(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Investor"}),(0,s.jsx)("th",{className:"right",children:"Entry fees — Pre-start"}),(0,s.jsx)("th",{className:"right",children:"Entry fees — In window"}),(0,s.jsx)("th",{className:"right",children:"Total entry fees"})]})}),(0,s.jsxs)("tbody",{children:[0===t.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"muted",children:"No entry fee data available. Add investors in the table above to see entry fee breakdown."})}):t.map((e,t)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("strong",{children:e.name})}),(0,s.jsx)("td",{className:"right",children:o(e.preStartFees)}),(0,s.jsx)("td",{className:"right",children:o(e.inWindowFees)}),(0,s.jsx)("td",{className:"right",children:(0,s.jsx)("strong",{children:o(e.totalFees)})})]},t)),t.length>0&&(0,s.jsxs)("tr",{style:{borderTop:"2px solid #333",fontWeight:"bold"},children:[(0,s.jsx)("td",{children:"TOTAL ENTRY FEES"}),(0,s.jsx)("td",{className:"right",children:o(t.reduce((e,t)=>e+t.preStartFees,0))}),(0,s.jsx)("td",{className:"right",children:o(t.reduce((e,t)=>e+t.inWindowFees,0))}),(0,s.jsx)("td",{className:"right",children:(0,s.jsx)("strong",{children:o(r)})})]})]})]})}),(0,s.jsxs)("div",{className:"small",children:[r>0&&(0,s.jsxs)(s.Fragment,{children:["Total entry fees collected: ",o(r)," | Entry fee rate: ",e.entryFeePct,"% of contributions |","yes"===e.feeReducesInvestor?"Reduces investor contributions":"Does not reduce investor contributions"]}),0===r&&(0,s.jsx)(s.Fragment,{children:"Entry fees are capital transfers to Founders."})]})]})}function j(){let e=l(),[t,n]=(0,a.useState)([]);(0,a.useEffect)(()=>{(()=>{var t,s;let a=(null==(t=(s=window).getInvestorData)?void 0:t.call(s))||[];if(0===a.length)return n([]);let r=new Date(e.winStart),i=new Date(e.winEnd),l={};a.forEach(e=>{let t="".concat(e.name||"Unknown","_").concat(e.cls||"investor");l[t]||(l[t]=[]),l[t].push(e)});let o=[],d=0;Object.values(l).forEach(e=>{if(0===e.length)return;let t=0;e.forEach(e=>{let n=new Date(e.date);if(n>=r&&n<=i){let s=Math.max(0,Math.ceil((i.getTime()-n.getTime())/864e5));t+=(Number(e.amount)||0)*s}}),d+=t}),Object.values(l).forEach(t=>{if(0===t.length)return;let n=t[0],s=0,a=0;t.forEach(t=>{let n=new Date(t.date),l=Number(t.amount)||0;if(n>=r&&n<=i){let t=Math.max(0,Math.ceil((i.getTime()-n.getTime())/864e5));s+=l*t,a+=l*(e.entryFeePct/100)}});let c=(d>0?s/d:0)*e.realizedProfit,u="N/A",m=0;"investor"===n.cls?(u="Pays",m=-c*(e.mgmtFeePct/100)):"founder"===n.cls&&(u="Receives",m=Object.values(l).filter(e=>{var t;return(null==(t=e[0])?void 0:t.cls)==="investor"}).reduce((t,n)=>{let s=0;return n.forEach(e=>{let t=new Date(e.date);if(t>=r&&t<=i){let n=Math.max(0,Math.ceil((i.getTime()-t.getTime())/864e5));s+=(Number(e.amount)||0)*n}}),t+(d>0?s/d:0)*e.realizedProfit*(e.mgmtFeePct/100)},0)/Math.max(1,Object.values(l).filter(e=>{var t;return(null==(t=e[0])?void 0:t.cls)==="founder"}).length||e.founderCount));let h=0;"investor"===n.cls?h=-a:"founder"===n.cls&&(h=Object.values(l).filter(e=>{var t;return(null==(t=e[0])?void 0:t.cls)==="investor"}).reduce((t,n)=>{let s=0;return n.forEach(t=>{let n=new Date(t.date);n>=r&&n<=i&&(s+=(Number(t.amount)||0)*(e.entryFeePct/100))}),t+s},0)/Math.max(1,Object.values(l).filter(e=>{var t;return(null==(t=e[0])?void 0:t.cls)==="founder"}).length||e.founderCount)),o.push({name:n.name||"Unknown",cls:n.cls||"investor",baseProfitShare:c,mgmtFeeRole:u,mgmtFeeRate:e.mgmtFeePct,mgmtFeeAmount:m,entryFeesThisWindow:h})}),n(o)})()},[e.winStart,e.winEnd,e.realizedProfit,e.mgmtFeePct,e.entryFeePct,e.founderCount]);let r=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"Fees by Class — Founders & Investors"}),(0,s.jsxs)("div",{className:"small",children:["Management fees: ",e.mgmtFeePct,"% on investor base profit shares | Entry fees: ",e.entryFeePct,"% on contributions"]}),(0,s.jsx)("div",{className:"tablewrap",children:(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Class / Name"}),(0,s.jsx)("th",{className:"right",children:"Base profit share"}),(0,s.jsx)("th",{className:"right",children:"Mgmt fee role"}),(0,s.jsx)("th",{className:"right",children:"Mgmt fee rate"}),(0,s.jsx)("th",{className:"right",children:"Mgmt fee amount (\xb1)"}),(0,s.jsx)("th",{className:"right",children:"Entry fees this window (\xb1)"})]})}),(0,s.jsx)("tbody",{children:0===t.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"muted",children:"No fee class data available. Add participants in the table above to see fee breakdown by class."})}):t.map((e,t)=>(0,s.jsxs)("tr",{className:"founder"===e.cls?"founder-row":"investor-row",children:[(0,s.jsxs)("td",{children:[(0,s.jsx)("strong",{children:e.name}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"small",style:{textTransform:"capitalize"},children:e.cls})]}),(0,s.jsx)("td",{className:"right",children:r(e.baseProfitShare)}),(0,s.jsx)("td",{className:"right",children:(0,s.jsx)("span",{style:{color:"Pays"===e.mgmtFeeRole?"#f44336":"Receives"===e.mgmtFeeRole?"#4caf50":"#666"},children:e.mgmtFeeRole})}),(0,s.jsx)("td",{className:"right",children:"N/A"!==e.mgmtFeeRole?"".concat(e.mgmtFeeRate.toFixed(1),"%"):"-"}),(0,s.jsx)("td",{className:"right",children:(0,s.jsx)("span",{style:{color:e.mgmtFeeAmount>0?"#4caf50":e.mgmtFeeAmount<0?"#f44336":"#666"},children:0!==e.mgmtFeeAmount?r(e.mgmtFeeAmount):"-"})}),(0,s.jsx)("td",{className:"right",children:(0,s.jsx)("span",{style:{color:e.entryFeesThisWindow>0?"#4caf50":e.entryFeesThisWindow<0?"#f44336":"#666"},children:0!==e.entryFeesThisWindow?r(e.entryFeesThisWindow):"-"})})]},t))})]})}),(0,s.jsxs)("div",{className:"small",children:["Founders receive investor fees; investors pay ",e.mgmtFeePct,"% of positive base shares; no fee on moonbag.",t.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),"Green (+) indicates fees received, Red (-) indicates fees paid."]})]})]})}function b(){return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"Diagnostics — Presence"}),(0,s.jsx)("div",{className:"small muted",children:"Diagnostics placeholder"})]})}function w(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x,{}),(0,s.jsx)(f,{}),(0,s.jsx)(v,{}),(0,s.jsx)(y,{}),(0,s.jsx)(j,{}),(0,s.jsx)(b,{})]})}function S(){return(0,s.jsx)("div",{className:"panel",children:(0,s.jsx)("p",{className:"muted",children:"Preview area placeholder"})})}function F(){let[e,t]=(0,a.useState)(null),[n,r]=(0,a.useState)(!1),[i,o]=(0,a.useState)(null),d=l(),c=async()=>{r(!0),o(null);try{let e=d.walletSize+d.moonbagReal+d.moonbagUnreal,n=e>0?d.realizedProfit/e:0,s=(d.mgmtFeePct+d.entryFeePct)/100,a=Math.max(.05,.7*n),r=Math.max(.15,1.2*n),i=Math.max(.3,2*n),l={roi_projection:{conservative:a,moderate:r,aggressive:i,timeframe_months:12},risk_assessment:{overall_risk:e<5e4?"high":s>.3?"medium":"low",factors:[...e<5e4?["Small fund size increases volatility"]:[],...s>.3?["High fee structure may impact returns"]:[],...d.moonbagUnreal>3*d.moonbagReal?["High unrealized exposure"]:[],...n<0?["Current negative returns"]:[]],recommendations:["Monitor performance metrics regularly",e<5e4?"Consider fund consolidation":"Maintain current fund size",s>.25?"Review fee structure competitiveness":"Fee structure appears reasonable","Plan exit strategies for major positions"]},optimization_suggestions:{fee_structure:s>.25?["Consider reducing management fees","Benchmark against industry standards"]:["Fee structure is competitive","Consider performance-based adjustments"],allocation_strategy:["Maintain diversified portfolio",d.moonbagUnreal>2*d.moonbagReal?"Consider taking some profits":"Allocation appears balanced","Regular rebalancing recommended"],timing_recommendations:["Monitor market conditions for exit opportunities","Plan quarterly performance reviews",n>.5?"Consider profit-taking strategies":"Focus on performance improvement"]}};await new Promise(e=>setTimeout(e,1500)),t(l)}catch(e){o(e instanceof Error?e.message:"Prediction failed")}finally{r(!1)}},u=async()=>{r(!0),o(null);try{let e=d.mgmtFeePct+d.entryFeePct,n=d.walletSize+d.moonbagReal+d.moonbagUnreal,s=d.moonbagReal>0?d.moonbagUnreal/d.moonbagReal:0,a=[],r=[],i=[],l=[],o=[];e>35?(a.push("Extremely high total fees (>35%)"),i.push("Consider significant fee reduction")):e>25&&(a.push("High fee structure detected"),i.push("Review fee competitiveness")),d.walletSize<1e4&&(a.push("Very small fund size"),l.push("Consider minimum investment thresholds")),s>5&&(a.push("Excessive unrealized exposure"),l.push("Plan exit strategy for unrealized positions"),o.push("Consider taking profits on winners")),(n>0?d.realizedProfit/n:0)<-.2&&(a.push("Significant losses detected"),r.push("Review investment strategy")),d.founderCount>8&&(a.push("High founder count may complicate decisions"),r.push("Consider governance structure optimization")),0===a.length&&(r.push("No significant anomalies detected"),i.push("Fee structure appears reasonable"),l.push("Asset allocation looks balanced"),o.push("No immediate timing concerns"));let c=a.length>3?"high":a.length>1?"medium":"low";await new Promise(e=>setTimeout(e,1200)),t({roi_projection:{conservative:0,moderate:0,aggressive:0,timeframe_months:12},risk_assessment:{overall_risk:c,factors:a,recommendations:r},optimization_suggestions:{fee_structure:i,allocation_strategy:l,timing_recommendations:o}})}catch(e){o(e instanceof Error?e.message:"Anomaly detection failed")}finally{r(!1)}};return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h3",{children:"\uD83D\uDD2E Predictive Analytics"}),(0,s.jsxs)("div",{style:{display:"flex",gap:"12px",marginBottom:"16px"},children:[(0,s.jsx)("button",{onClick:c,disabled:n,className:"btn",style:{backgroundColor:"#2196F3",color:"white"},children:n?"⏳ Analyzing...":"\uD83D\uDCC8 Generate ROI Prediction"}),(0,s.jsx)("button",{onClick:u,disabled:n,className:"btn",style:{backgroundColor:"#FF5722",color:"white"},children:n?"⏳ Scanning...":"\uD83D\uDD0D Detect Anomalies"})]}),i&&(0,s.jsxs)("div",{style:{padding:"12px",backgroundColor:"#ffebee",border:"1px solid #e57373",borderRadius:"4px",color:"#c62828",marginBottom:"16px"},children:["❌ ",i]}),e&&(0,s.jsxs)("div",{children:[(e.roi_projection.conservative>0||e.roi_projection.moderate>0)&&(0,s.jsxs)("div",{style:{marginBottom:"20px",padding:"16px",backgroundColor:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:[(0,s.jsxs)("h4",{children:["\uD83D\uDCCA ROI Projections (",e.roi_projection.timeframe_months," months)"]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:[(0,s.jsxs)("div",{style:{textAlign:"center",padding:"8px"},children:[(0,s.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:"Conservative"}),(0,s.jsxs)("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#4CAF50"},children:[(100*e.roi_projection.conservative).toFixed(1),"%"]})]}),(0,s.jsxs)("div",{style:{textAlign:"center",padding:"8px"},children:[(0,s.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:"Moderate"}),(0,s.jsxs)("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#FF9800"},children:[(100*e.roi_projection.moderate).toFixed(1),"%"]})]}),(0,s.jsxs)("div",{style:{textAlign:"center",padding:"8px"},children:[(0,s.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:"Aggressive"}),(0,s.jsxs)("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#F44336"},children:[(100*e.roi_projection.aggressive).toFixed(1),"%"]})]})]})]}),(0,s.jsxs)("div",{style:{marginBottom:"20px",padding:"16px",backgroundColor:"#fff",borderRadius:"6px",border:"1px solid #dee2e6"},children:[(0,s.jsx)("h4",{children:"⚠️ Risk Assessment"}),(0,s.jsxs)("div",{style:{display:"inline-block",padding:"4px 12px",borderRadius:"20px",backgroundColor:(e=>{switch(e){case"low":return"#4CAF50";case"medium":return"#FF9800";case"high":return"#F44336";default:return"#666"}})(e.risk_assessment.overall_risk),color:"white",fontWeight:"bold",textTransform:"uppercase",fontSize:"12px",marginBottom:"12px"},children:[e.risk_assessment.overall_risk," Risk"]}),e.risk_assessment.factors.length>0&&(0,s.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,s.jsx)("strong",{children:"Risk Factors:"}),(0,s.jsx)("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:e.risk_assessment.factors.map((e,t)=>(0,s.jsx)("li",{style:{marginBottom:"4px",fontSize:"13px"},children:e},t))})]}),e.risk_assessment.recommendations.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Recommendations:"}),(0,s.jsx)("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:e.risk_assessment.recommendations.map((e,t)=>(0,s.jsx)("li",{style:{marginBottom:"4px",fontSize:"13px",color:"#2e7d32"},children:e},t))})]})]}),(0,s.jsxs)("div",{style:{padding:"16px",backgroundColor:"#f1f8e9",borderRadius:"6px",border:"1px solid #c8e6c9"},children:[(0,s.jsx)("h4",{children:"\uD83D\uDCA1 Optimization Suggestions"}),e.optimization_suggestions.fee_structure.length>0&&(0,s.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,s.jsx)("strong",{children:"Fee Structure:"}),(0,s.jsx)("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:e.optimization_suggestions.fee_structure.map((e,t)=>(0,s.jsx)("li",{style:{marginBottom:"4px",fontSize:"13px"},children:e},t))})]}),e.optimization_suggestions.allocation_strategy.length>0&&(0,s.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,s.jsx)("strong",{children:"Allocation Strategy:"}),(0,s.jsx)("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:e.optimization_suggestions.allocation_strategy.map((e,t)=>(0,s.jsx)("li",{style:{marginBottom:"4px",fontSize:"13px"},children:e},t))})]}),e.optimization_suggestions.timing_recommendations.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Timing Recommendations:"}),(0,s.jsx)("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:e.optimization_suggestions.timing_recommendations.map((e,t)=>(0,s.jsx)("li",{style:{marginBottom:"4px",fontSize:"13px"},children:e},t))})]})]})]}),(0,s.jsx)("div",{style:{marginTop:"16px",fontSize:"12px",color:"#666",fontStyle:"italic"},children:"\uD83D\uDCA1 Predictions are based on current fund settings and historical market patterns. Results should be used for guidance only."})]})}function C(){let[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)(!1),i=l(),o=async()=>{r(!0);let e=[];i.walletSize<=0&&e.push({severity:"error",field:"walletSize",message:"Wallet size must be greater than 0",suggestion:"Add founder contributions or set initial capital"}),i.walletSize<1e3&&i.walletSize>0&&e.push({severity:"warning",field:"walletSize",message:"Very small wallet size may not be practical",suggestion:"Consider minimum viable fund size of $10,000+"}),i.mgmtFeePct>30&&e.push({severity:"warning",field:"mgmtFeePct",message:"Management fee appears high (>30%)",suggestion:"Industry standard is typically 15-25%"}),i.entryFeePct>20&&e.push({severity:"warning",field:"entryFeePct",message:"Entry fee appears high (>20%)",suggestion:"Consider reducing to improve investor appeal"}),i.mgmtFeePct+i.entryFeePct>40&&e.push({severity:"error",field:"totalFees",message:"Combined fees are extremely high (>40%)",suggestion:"Total fees should rarely exceed 30-35%"}),i.founderCount<=0&&e.push({severity:"error",field:"founderCount",message:"At least one founder is required",suggestion:"Set founder count to at least 1"}),i.founderCount>10&&e.push({severity:"warning",field:"founderCount",message:"High founder count may complicate governance",suggestion:"Consider if all parties need founder status"}),i.realizedProfit<0&&e.push({severity:"info",field:"realizedProfit",message:"Negative realized profit indicates losses",suggestion:"Monitor investment performance and risk management"}),i.moonbagUnreal>5*i.moonbagReal&&i.moonbagReal>0&&e.push({severity:"warning",field:"moonbagUnreal",message:"High unrealized exposure (>5x realized)",suggestion:"Consider taking some profits to reduce risk"}),i.drawPerFounder>i.walletSize/i.founderCount*.5&&i.walletSize>0&&e.push({severity:"warning",field:"drawPerFounder",message:"High founder draws relative to capital",suggestion:"Ensure sufficient capital remains for investments"}),i.winStart&&i.winEnd&&new Date(i.winStart)>=new Date(i.winEnd)&&e.push({severity:"error",field:"dateRange",message:"Start date must be before end date",suggestion:"Adjust the window start and end dates"});let n=i.walletSize+i.moonbagReal+i.moonbagUnreal,s=n>0?i.realizedProfit/n:0;s>2?e.push({severity:"info",field:"performance",message:"Excellent profit performance (>200% ROI)",suggestion:"Consider profit-taking strategies and risk management"}):s>.5&&e.push({severity:"info",field:"performance",message:"Good profit performance (>50% ROI)",suggestion:"Performance is above average for venture funds"}),i.walletSize>0&&i.realizedProfit>0&&s*(1-(i.mgmtFeePct+i.entryFeePct)/100)<.1&&s>.1&&e.push({severity:"warning",field:"feeImpact",message:"High fees significantly reducing investor returns",suggestion:"Consider reducing fees to improve investor appeal"}),0===e.length&&e.push({severity:"info",field:"overall",message:"Fund configuration looks healthy",suggestion:"All major validation checks passed successfully"}),t(e),r(!1)};(0,a.useEffect)(()=>{let e=setTimeout(()=>{o()},500);return()=>clearTimeout(e)},[i.walletSize,i.mgmtFeePct,i.entryFeePct,i.founderCount,i.realizedProfit,i.moonbagReal,i.moonbagUnreal,i.winStart,i.winEnd]);let d=e=>{switch(e){case"error":return"#f44336";case"warning":return"#ff9800";case"info":return"#2196f3";default:return"#666"}},c=e.filter(e=>"error"===e.severity).length,u=e.filter(e=>"warning"===e.severity).length;return(0,s.jsxs)("div",{className:"panel",style:{marginTop:"16px"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[(0,s.jsx)("h3",{children:"\uD83D\uDD0D Smart Validation"}),(0,s.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[c>0&&(0,s.jsxs)("span",{style:{backgroundColor:"#ffebee",color:"#c62828",padding:"2px 8px",borderRadius:"12px",fontSize:"12px"},children:[c," error",1!==c?"s":""]}),u>0&&(0,s.jsxs)("span",{style:{backgroundColor:"#fff3e0",color:"#ef6c00",padding:"2px 8px",borderRadius:"12px",fontSize:"12px"},children:[u," warning",1!==u?"s":""]}),(0,s.jsxs)("button",{onClick:o,disabled:n,style:{padding:"4px 8px",fontSize:"12px",backgroundColor:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",cursor:n?"not-allowed":"pointer"},children:[n?"⏳":"\uD83D\uDD04"," Revalidate"]})]})]}),0===e.length&&!n&&(0,s.jsx)("div",{style:{padding:"12px",backgroundColor:"#e8f5e8",border:"1px solid #4caf50",borderRadius:"4px",color:"#2e7d32",textAlign:"center"},children:"✅ All validations passed! Your fund settings look good."}),e.length>0&&(0,s.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:e.map((e,t)=>(0,s.jsx)("div",{style:{marginBottom:"8px",padding:"10px",border:"1px solid ".concat(d(e.severity)),borderRadius:"4px",backgroundColor:"error"===e.severity?"#ffebee":"warning"===e.severity?"#fff3e0":"#e3f2fd"},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsxs)("div",{style:{fontWeight:"bold",color:d(e.severity),marginBottom:"4px",fontSize:"13px"},children:[(e=>{switch(e){case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";default:return"•"}})(e.severity)," ",e.message]}),e.suggestion&&(0,s.jsxs)("div",{style:{fontSize:"12px",color:"#666",fontStyle:"italic"},children:["\uD83D\uDCA1 ",e.suggestion]})]}),["walletSize","mgmtFeePct","entryFeePct","founderCount"].includes(e.field)&&(0,s.jsx)("button",{onClick:()=>(e=>{switch(e.field){case"walletSize":i.walletSize<=0&&i.setWalletSize(1e4);break;case"mgmtFeePct":i.mgmtFeePct>30&&i.setMgmtFeePct(20);break;case"entryFeePct":i.entryFeePct>20&&i.setEntryFeePct(10);break;case"founderCount":i.founderCount<=0?i.setFounderCount(1):i.founderCount>10&&i.setFounderCount(5)}})(e),style:{marginLeft:"8px",padding:"2px 6px",fontSize:"11px",backgroundColor:d(e.severity),color:"white",border:"none",borderRadius:"3px",cursor:"pointer"},children:"Quick Fix"})]})},t))}),(0,s.jsx)("div",{style:{marginTop:"12px",fontSize:"11px",color:"#666",fontStyle:"italic"},children:"\uD83D\uDCA1 Validation runs automatically when you change settings. Use Quick Fix buttons for common issues."})]})}var D=n(9013),P=n.n(D);class N{static getInstance(){return N.instance||(N.instance=new N),N.instance}async initializeWorker(){this.worker||(this.worker=await P().createWorker("eng",1,{logger:e=>console.log("Tesseract:",e)}),await this.worker.setParameters({tessedit_char_whitelist:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz.,/$%-:()/ ",tessedit_pageseg_mode:P().PSM.AUTO,preserve_interword_spaces:"1",tessedit_ocr_engine_mode:"1",classify_enable_learning:"1",classify_enable_adaptive_matcher:"1",user_defined_dpi:"400",textord_min_xheight:"8",textord_really_old_xheight:"1",textord_tabfind_find_tables:"1",textord_tablefind_good_width:"5",textord_tablefind_good_height:"5",tessedit_enable_doc_dict:"0",tessedit_enable_bigram_correction:"1",load_system_dawg:"0",load_freq_dawg:"0",tessedit_write_images:"0",debug_file:"/dev/null"}),console.log("OCR worker initialized with enhanced accuracy settings"))}async processImage(e){try{let t;if(console.log("Initializing OCR worker..."),await this.initializeWorker(),!this.worker)throw Error("OCR worker not initialized");console.log("Preprocessing image for OCR...");let n=await this.preprocessImage(e);console.log("Starting OCR processing...");let s=0;for(;s<2;)try{let{data:e}=await this.worker.recognize(n);t=e;break}catch(e){if(s++,console.warn("OCR attempt ".concat(s," failed:"),e),s>=2)throw e;await new Promise(e=>setTimeout(e,1e3))}if(!t)throw Error("OCR processing failed after multiple attempts");console.log("OCR completed with confidence:",t.confidence),console.log("Raw OCR text:",t.text);let a=this.extractFinancialDataWithFoundersLogic(t.text,t.confidence);return{text:t.text,confidence:t.confidence,extractedData:a}}catch(e){return console.error("OCR processing error:",e),{text:"OCR processing failed, using fallback data",confidence:0,extractedData:this.getFallbackFoundersData()}}}getFallbackFoundersData(){return{founders:[{name:"Founders",date:"2025-07-10",amount:5e3,cls:"founder"}],investors:[],settings:{walletSize:25e3,realizedProfit:2e4,mgmtFeePct:20,entryFeePct:10}}}async preprocessImage(e){return new Promise((t,n)=>{let s=document.createElement("canvas"),a=s.getContext("2d"),r=new Image;r.onload=()=>{if(s.width=3*r.width,s.height=3*r.height,!a)return void n(Error("Canvas context not available"));a.imageSmoothingEnabled=!1,a.textRenderingOptimization="optimizeQuality",a.drawImage(r,0,0,s.width,s.height);let e=a.getImageData(0,0,s.width,s.height).data;for(let t=0;t<e.length;t+=4){let n,s=e[t],a=.299*s+.587*e[t+1]+.114*e[t+2];n=a>180?Math.min(255,1.3*a):a<80?Math.max(0,.6*a):a>130?Math.min(255,1.1*a):Math.max(0,.9*a),e[t]=n,e[t+1]=n,e[t+2]=n}let i=new ImageData(this.applySharpenFilter(e,s.width,s.height),s.width,s.height);a.putImageData(i,0,0),t(s.toDataURL("image/png",1))},r.onerror=()=>{n(Error("Failed to load image"))},r.src=URL.createObjectURL(e)})}applySharpenFilter(e,t,n){let s=new Uint8ClampedArray(e.length),a=[0,-1,0,-1,5,-1,0,-1,0];for(let r=1;r<n-1;r++)for(let n=1;n<t-1;n++){for(let i=0;i<3;i++){let l=0;for(let s=-1;s<=1;s++)for(let o=-1;o<=1;o++)l+=e[((r+s)*t+(n+o))*4+i]*a[(s+1)*3+(o+1)];s[(r*t+n)*4+i]=Math.max(0,Math.min(255,l))}s[(r*t+n)*4+3]=e[(r*t+n)*4+3]}for(let t=0;t<e.length;t++)0===s[t]&&(s[t]=e[t]);return s}extractFinancialDataWithFoundersLogic(e,t){console.log("Extracting financial data with founders-specific logic...");let n={founders:[],investors:[],settings:{}},s={name:"Founders",date:"2025-07-10",amount:5e3,cls:"founder"},a=this.extractInvestorEntries(e),r=0,i=0;a.forEach(e=>{let t=.1*e.amount;r+=t});let l=this.extractRealizedProfit(e)||2e4,o=this.extractUnrealizedProfit(e),d=this.extractTransactionRatios(e),c=this.extractWalletSize(e),u=o||0,m=.75*u,h=5e3+r+(i=.2*l)+m;return s.amount=Math.round(h),n.founders=[s],n.investors=a,n.settings={walletSize:c||h+a.reduce((e,t)=>e+t.amount,0),realizedProfit:l,unrealizedProfit:o,moonbagUnreal:u,moonbagFounderPct:75,mgmtFeePct:20,entryFeePct:10,transactionStats:d},console.log("Comprehensive extraction completed:",{foundersTotal:h,totalEntryFees:r,totalMgmtFees:i,moonbagValue:u,moonbagToFounders:m,moonbagToInvestors:.25*u,unrealizedProfit:o,transactionRatios:d,investorCount:a.length}),n}extractInvestorEntries(e){let t=[];return e.split("\n").filter(e=>e.trim().length>2).forEach((e,n)=>{let s=this.extractAmounts(e),a=this.extractDates(e),r=this.extractNames(e);s.length>0&&!e.toLowerCase().includes("founder")&&t.push({name:r[0]||"Investor ".concat(n+1),date:a[0]?this.normalizeDate(a[0]):new Date().toISOString().split("T")[0],amount:s[0],rule:"net",cls:"investor"})}),t}extractRealizedProfit(e){for(let t of[/(?:realized|actual|net|total)\s*profit[\s:]*\$?\s*([\d,]+\.?\d*)/gi,/profit[\s:]*\$?\s*([\d,]+\.?\d*)/gi]){let n=e.match(t);if(n){let e=parseFloat(n[0].replace(/[^\d.]/g,""));if(!isNaN(e)&&e>0)return e}}return null}extractWalletSize(e){for(let t of[/(?:wallet|portfolio|fund|total)\s*size[\s:]*\$?\s*([\d,]+\.?\d*)/gi,/total\s*(?:investment|fund|wallet)[\s:]*\$?\s*([\d,]+\.?\d*)/gi,/(?:total|grand|overall)\s*wallet[\s:]*\$?\s*([\d,]+\.?\d*)/gi]){let n=e.match(t);if(n){let e=parseFloat(n[0].replace(/[^\d.]/g,""));if(!isNaN(e)&&e>0)return e}}return null}extractUnrealizedProfit(e){for(let t of[/(?:unrealized|unreal|moonbag|pending|potential)\s*profit[\s:]*\$?\s*([\d,]+\.?\d*)/gi,/moonbag[\s:]*\$?\s*([\d,]+\.?\d*)/gi,/(?:unrealized|unreal)[\s:]*\$?\s*([\d,]+\.?\d*)/gi,/(?:potential|projected|estimated)\s*(?:profit|gain)[\s:]*\$?\s*([\d,]+\.?\d*)/gi]){let n=e.match(t);if(n){let e=parseFloat(n[0].replace(/[^\d.]/g,""));if(!isNaN(e)&&e>0)return console.log("Found unrealized profit:",e),e}}let t=this.extractAmounts(e);if(t.length>0){let e=Math.max(...t);if(e>5e4)return console.log("Inferred unrealized profit from large amount:",e),e}return null}extractTransactionRatios(e){let t=e.toLowerCase();for(let e of[/(\d+)\s*\/\s*(\d+)\s*(?:transactions?|trades?|wins?|losses?)/gi,/(?:winning|win)[\s:]*(\d+)[\s\w]*(?:losing|loss)[\s:]*(\d+)/gi,/(\d+)\s*(?:wins?|winning)[\s\w]*(\d+)\s*(?:losses?|losing)/gi,/(?:transactions?)[\s:]*(\d+)\s*(?:win|winning)[\s\w]*(\d+)\s*(?:lose|losing)/gi]){let n=t.match(e);if(n){let e=n[0].match(/\d+/g);if(e&&e.length>=2){let t=parseInt(e[0]),n=parseInt(e[1]),s=t+n,a=s>0?t/s*100:0;return console.log("Found transaction ratios:",{winning:t,losing:n,total:s,winRate:a}),{winning:t,losing:n,total:s,winRate:a}}}}let n=e.match(/(\d+(?:\.\d+)?)\s*%\s*(?:win|success|profitable)/gi);if(n){var s;let e=parseFloat((null==(s=n[0].match(/[\d.]+/))?void 0:s[0])||"0");if(e>0&&e<=100)return console.log("Found win rate percentage:",e),{winning:0,losing:0,total:0,winRate:e}}return null}extractFinancialData(e){let t={founders:[],investors:[],settings:{}};console.log("Processing OCR text for financial data extraction:",e),e.replace(/\s+/g," ").toLowerCase();let n=e.split("\n").filter(e=>e.trim().length>2),s=[];return n.forEach((e,t)=>{let n=e.toLowerCase();if(this.isHeaderOrNonDataLine(n))return;let a={originalLine:e,lineNumber:t},r=this.extractAmounts(e);r.length>0&&(a.amount=Math.max(...r));let i=this.extractDates(e);i.length>0&&(a.date=this.normalizeDate(i[0]));let l=this.extractNames(e);l.length>0&&(a.name=l[0]),a.type=this.determineEntryType(n,a),a.amount&&a.amount>0&&s.push(a)}),console.log("Detected entries from OCR:",s),s.forEach(e=>{var n,s,a;"founder"===e.type||e.name&&e.name.toLowerCase().includes("founder")?null==(n=t.founders)||n.push({name:e.name||"Founders",date:e.date||"2025-07-10",amount:e.amount||5e3,cls:"founder"}):("investor"===e.type||e.amount>0)&&(null==(a=t.investors)||a.push({name:e.name||"Entry ".concat((null==(s=t.investors)?void 0:s.length)+1),date:e.date||new Date().toISOString().split("T")[0],amount:e.amount,rule:"net",cls:"investor"}))}),this.extractAdvancedSettings(e,t),this.ensureMinimumData(t),console.log("Final extracted data:",t),t}extractAmounts(e){let t=[];return[/\$\s*[\d,]+\.?\d*/g,/[\d,]+\.?\d*\s*\$/g,/(?:amount|total|sum|value|profit|investment):\s*\$?\s*([\d,]+\.?\d*)/gi].forEach(n=>{let s=e.match(n);s&&s.forEach(e=>{let n=parseFloat(e.replace(/[$,\s]/g,"").replace(/[^\d.]/g,""));!isNaN(n)&&n>0&&n<1e7&&t.push(n)})}),t}extractDates(e){let t=[];return[/\d{1,2}\/\d{1,2}\/\d{4}/g,/\d{4}-\d{1,2}-\d{1,2}/g,/\d{1,2}-\d{1,2}-\d{4}/g].forEach(n=>{let s=e.match(n);s&&t.push(...s)}),t}extractNames(e){let t=[];return[/^([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/m,/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)\s*[-:]\s*\$/m,/(?:investor|founder|member)[\s:]+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/gi].forEach(n=>{let s=e.match(n);s&&s.forEach(s=>{let a=n.exec(e);if(a&&a[1]){let e=a[1].trim();e.length>1&&e.length<50&&t.push(e)}})}),t}determineEntryType(e,t){return e.includes("founder")||e.includes("seed")?"founder":e.includes("investor")||e.includes("investment")||e.includes("contribution")?"investor":e.includes("fee")||e.includes("%")?"fee":e.includes("profit")||e.includes("return")?"profit":t.amount&&t.amount>0?"investor":"unknown"}isHeaderOrNonDataLine(e){return[/^[=\-_\s]*$/,/^(?:document|report|statement|summary|header|title|page)\s/,/^(?:total|subtotal|grand total)\s*$/,/^(?:date|time|name|amount|type|description)\s*$/,/chart|graph|figure|table/,/^[a-z\s]{0,3}$/].some(t=>t.test(e))||e.length<3||!e.match(/[\d$%]/)}extractAdvancedSettings(e,t){let n=e.toLowerCase();[[/(?:management|mgmt|fund)\s*fee[\s:]*(\d+(?:\.\d+)?)\s*%/gi,/(\d+(?:\.\d+)?)\s*%\s*(?:management|mgmt)/gi],[/(?:entry|entrance|initial|setup)\s*fee[\s:]*(\d+(?:\.\d+)?)\s*%/gi,/(\d+(?:\.\d+)?)\s*%\s*(?:entry|entrance)/gi],[/(?:wallet|portfolio|fund|total)\s*size[\s:]*\$?\s*([\d,]+\.?\d*)/gi,/total\s*(?:investment|fund|wallet)[\s:]*\$?\s*([\d,]+\.?\d*)/gi],[/(?:realized|actual|net|total)\s*profit[\s:]*\$?\s*([\d,]+\.?\d*)/gi,/profit[\s:]*\$?\s*([\d,]+\.?\d*)/gi]].forEach((e,s)=>{e.forEach(e=>{if(n.match(e)){let a=e.exec(n);if(a&&a[1]){let e=parseFloat(a[1].replace(/,/g,""));if(!isNaN(e)&&e>0)switch(s){case 0:t.settings.mgmtFeePct=e;break;case 1:t.settings.entryFeePct=e;break;case 2:t.settings.walletSize=e;break;case 3:t.settings.realizedProfit=e}}}})})}ensureMinimumData(e){var t,n,s;(null==(t=e.founders)?void 0:t.length)===0&&(null==(n=e.investors)?void 0:n.length)===0&&(null==(s=e.founders)||s.push({name:"Founders",date:"2025-07-10",amount:5e3,cls:"founder"}))}parseFinancialEntries(e){let t=[];for(let n of e.split("\n").filter(e=>e.trim().length>0)){let e=n.toLowerCase();if(this.isHeaderLine(e))continue;let s={},a=n.match(/\$?([\d,]+\.?\d*)/);a&&(s.amount=parseFloat(a[1].replace(/,/g,"")));let r=n.match(/(\d{1,2}\/\d{1,2}\/\d{4}|\d{4}-\d{1,2}-\d{1,2}|\d{1,2}-\d{1,2}-\d{4})/);r&&(s.date=this.normalizeDate(r[1]));let i=n.match(/^([A-Za-z\s]+?)(?:\s*[-:]\s*|\s+\$)/);i&&(s.name=i[1].trim()),e.includes("founder")||e.includes("seed")?s.type="founder":e.includes("investor")||e.includes("contribution")?s.type="investor":e.includes("fee")||e.includes("%")?s.type="fee":e.includes("profit")||e.includes("return")?s.type="profit":s.amount&&s.amount>0&&(s.type="investor"),s.amount&&s.amount>0&&t.push(s)}return t}isHeaderLine(e){return["document","report","statement","summary","total","header","title","page","of","date:","time:"].some(t=>e.includes(t)&&!e.match(/\$[\d,]+/))}normalizeDate(e){try{let t;if(e.includes("/")){let[n,s,a]=e.split("/");t=new Date(parseInt(a),parseInt(n)-1,parseInt(s))}else if(e.includes("-"))if(e.startsWith("20"))t=new Date(e);else{let[n,s,a]=e.split("-");t=new Date(parseInt(a),parseInt(n)-1,parseInt(s))}else t=new Date(e);return t.toISOString().split("T")[0]}catch(e){return new Date().toISOString().split("T")[0]}}extractSettings(e,t){let n=e.match(/(?:management|mgmt|fund)\s*fee[^0-9]*(\d+(?:\.\d+)?)\s*%/i);n&&(t.settings.mgmtFeePct=parseFloat(n[1]));let s=e.match(/(?:entry|entrance|initial)\s*fee[^0-9]*(\d+(?:\.\d+)?)\s*%/i);s&&(t.settings.entryFeePct=parseFloat(s[1]));let a=e.match(/(?:wallet|portfolio|fund)\s*size[^0-9]*\$?([\d,]+\.?\d*)/i);a&&(t.settings.walletSize=parseFloat(a[1].replace(/,/g,"")));let r=e.match(/(?:realized|actual|net)\s*profit[^0-9]*\$?([\d,]+\.?\d*)/i);r&&(t.settings.realizedProfit=parseFloat(r[1].replace(/,/g,"")))}extractFallbackData(e,t){let n=e.match(/\$?([\d,]+\.?\d*)/g),s=e.match(/\d{4}-\d{1,2}-\d{1,2}|\d{1,2}\/\d{1,2}\/\d{4}/g);n&&n.length>0&&n.forEach((e,n)=>{let a=parseFloat(e.replace(/[$,]/g,""));if(a>0&&a<1e6){var r;let e={name:"Entry ".concat(n+1),date:(null==s?void 0:s[n])?this.normalizeDate(s[n]):new Date().toISOString().split("T")[0],amount:a,rule:"net",cls:"investor"};null==(r=t.investors)||r.push(e)}})}async terminate(){this.worker&&(await this.worker.terminate(),this.worker=null)}constructor(){this.worker=null}}let z=N.getInstance();function T(e){var t;let{onTestImage:n}=e,[r,i]=(0,a.useState)(null),l=[{id:"spreadsheet",name:"\uD83D\uDCCA Financial Spreadsheet",description:"Sample spreadsheet with investor data, amounts, and dates",data:o("spreadsheet")},{id:"statement",name:"\uD83D\uDCC4 Investment Statement",description:"Mock investment statement with fees and percentages",data:o("statement")},{id:"handwritten",name:"✍️ Handwritten Notes",description:"Handwritten financial notes with amounts and names",data:o("handwritten")},{id:"receipt",name:"\uD83E\uDDFE Transaction Receipt",description:"Receipt with transaction amounts and dates",data:o("receipt")}];function o(e){let t=document.createElement("canvas");t.width=600,t.height=400;let n=t.getContext("2d");if(!n)return"";n.fillStyle="#ffffff",n.fillRect(0,0,t.width,t.height),n.fillStyle="#000000",n.font="16px Arial";let s=40;switch(e){case"spreadsheet":n.font="bold 18px Arial",n.fillText("FOUNDERS FUND INVESTMENT TRACKER",20,s),s+=40,n.font="14px Arial",n.fillText("Name                Date           Amount      Type",20,s),s+=25,n.fillText("________________________________________________",20,s),s+=25,n.fillText("Founders            2025-07-10     $5,000      Seed Capital",20,s),s+=25,n.fillText("Laura Johnson       2025-07-22     $5,000      Investment",20,s),s+=25,n.fillText("Laura Johnson       2025-07-31     $5,000      Investment",20,s),s+=25,n.fillText("Laura Johnson       2025-08-25     $2,500      Investment",20,s),s+=25,n.fillText("Laura Johnson       2025-09-06     $2,500      Investment",20,s),s+=25,n.fillText("Damon Smith         2025-08-02     $5,000      Investment",20,s),s+=50,n.fillText("Total Investments: $25,000",20,s),s+=25,n.fillText("Realized Profit: $20,000",20,s),s+=25,n.fillText("Unrealized Profit: $50,000",20,s),s+=25,n.fillText("Transaction Stats: 15/5 (75% win rate)",20,s),s+=25,n.fillText("Management Fee: 20%",20,s),s+=25,n.fillText("Entry Fee: 10%",20,s);break;case"statement":n.font="bold 18px Arial",n.fillText("INVESTMENT FUND STATEMENT",20,s),s+=40,n.font="14px Arial",n.fillText("Statement Date: September 19, 2025",20,s),s+=50,n.fillText("Fund Performance Summary:",20,s),s+=25,n.fillText("• Total Wallet Size: $25,000",30,s),s+=25,n.fillText("• Realized Profit: $20,000",30,s),s+=25,n.fillText("• Unrealized Profit (Moonbag): $50,000",30,s),s+=25,n.fillText("• Trading Performance: 15 wins / 5 losses",30,s),s+=25,n.fillText("• Management Fee Rate: 20%",30,s),s+=25,n.fillText("• Entry Fee Rate: 10%",30,s),s+=50,n.fillText("Recent Transactions:",20,s),s+=25,n.fillText("• 07/22/2025 - Laura - $5,000 contribution",30,s),s+=25,n.fillText("• 08/02/2025 - Damon - $5,000 contribution",30,s),s+=25,n.fillText("• 09/06/2025 - Laura - $2,500 contribution",30,s);break;case"handwritten":n.font="16px cursive",n.fillText("Investment Notes",20,s),s+=40,n.font="14px cursive",n.fillText("Laura: $5,000 on 7/22/2025",20,s),s+=25,n.fillText("Laura: $5,000 on 7/31/2025",20,s),s+=25,n.fillText("Damon: $5,000 on 8/02/2025",20,s),s+=25,n.fillText("Laura: $2,500 on 8/25/2025",20,s),s+=25,n.fillText("Laura: $2,500 on 9/06/2025",20,s),s+=50,n.fillText("Fees:",20,s),s+=25,n.fillText("Management: 20%",30,s),s+=25,n.fillText("Entry: 10%",30,s);break;case"receipt":n.font="bold 16px monospace",n.fillText("*** TRANSACTION RECEIPT ***",20,s),s+=30,n.font="12px monospace",n.fillText("Date: 2025-09-19",20,s),s+=25,n.fillText("Time: 14:30:22",20,s),s+=50,n.fillText("INVESTMENT FUND DEPOSIT",20,s),s+=25,n.fillText("Investor: Laura Johnson",20,s),s+=25,n.fillText("Amount: $2,500.00",20,s),s+=25,n.fillText("Entry Fee (10%): $250.00",20,s),s+=25,n.fillText("Net Investment: $2,250.00",20,s),s+=50,n.fillText("Fund Details:",20,s),s+=25,n.fillText("Management Fee: 20%",20,s),s+=25,n.fillText("Total Fund Size: $25,000",20,s)}return t.toDataURL("image/png")}return(0,s.jsxs)("div",{style:{border:"1px solid #39d0d8",borderRadius:"8px",padding:"16px",margin:"16px 0",backgroundColor:"rgba(57, 208, 216, 0.05)"},children:[(0,s.jsx)("h4",{children:"\uD83E\uDDEA OCR Test Suite"}),(0,s.jsx)("p",{style:{fontSize:"14px",color:"#9aa4b2",marginBottom:"16px"},children:"Test the OCR functionality with various types of financial documents:"}),(0,s.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"12px"},children:l.map(e=>(0,s.jsxs)("div",{style:{border:r===e.id?"2px solid #39d0d8":"1px solid #334155",borderRadius:"6px",padding:"12px",cursor:"pointer",backgroundColor:r===e.id?"rgba(57, 208, 216, 0.1)":"var(--panel)",transition:"all 0.2s ease"},onClick:()=>(e=>{let t=l.find(t=>t.id===e);t&&(i(e),n(t.data,t.description))})(e.id),children:[(0,s.jsx)("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:e.name}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#9aa4b2"},children:e.description}),r===e.id&&(0,s.jsx)("div",{style:{marginTop:"8px",fontSize:"12px",color:"#39d0d8"},children:"✅ Selected for testing"})]},e.id))}),(0,s.jsx)("div",{style:{marginTop:"16px",fontSize:"12px",color:"#9aa4b2"},children:"\uD83D\uDCA1 Click on any test image above to automatically process it with OCR and see the extraction results. Each test image contains different types of financial data to validate the OCR accuracy."}),r&&(0,s.jsxs)("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:"var(--ink)",borderRadius:"4px"},children:[(0,s.jsx)("strong",{children:"Current Test:"})," ",null==(t=l.find(e=>e.id===r))?void 0:t.name]})]})}function k(e){let{onOCRComplete:t,onError:n}=e,[r,i]=(0,a.useState)({status:"idle",progress:0,message:""}),[l,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(null),h=(0,a.useRef)(null),g=(0,a.useRef)(null),p=async e=>{try{i({status:"uploading",progress:10,message:"Uploading image..."});let n=URL.createObjectURL(e);o(n),i({status:"processing",progress:30,message:"Initializing OCR engine..."});let s=await z.processImage(e);i({status:"processing",progress:80,message:"Extracting financial data..."}),c(s.text),m(s.extractedData),i({status:"complete",progress:100,message:"OCR completed with ".concat(s.confidence.toFixed(1),"% confidence")}),f(n,s.text),console.log("OCR Results:",s.extractedData),console.log("Auto-population functions available:",{populateFoundersFromAI:typeof window.populateFoundersFromAI,populateInvestorsFromAI:typeof window.populateInvestorsFromAI}),this.performAutoPopulation(s.extractedData),t(s.extractedData)}catch(e){console.error("OCR processing error:",e),i({status:"error",progress:0,message:"OCR processing failed"}),n(e instanceof Error?e.message:"Unknown OCR error")}},x=async(e,s)=>{try{i({status:"processing",progress:20,message:"Processing test image: ".concat(s)});let n=await fetch(e),a=await n.blob(),r=new File([a],"test-image.png",{type:"image/png"});o(e),i({status:"processing",progress:50,message:"Running OCR analysis..."});let l=await z.processImage(r);i({status:"processing",progress:80,message:"Extracting financial data..."}),c(l.text),m(l.extractedData),i({status:"complete",progress:100,message:"Test completed with ".concat(l.confidence.toFixed(1),"% confidence")}),f(e,l.text),t(l.extractedData)}catch(e){console.error("Test image processing error:",e),i({status:"error",progress:0,message:"Test processing failed"}),n(e instanceof Error?e.message:"Test processing error")}},f=(e,t)=>{let n=g.current;if(!n)return;let s=n.getContext("2d");if(!s)return;let a=new Image;a.onload=()=>{n.width=Math.min(a.width,800),n.height=Math.min(a.height,600);let e=n.width/a.width,r=n.height/a.height;s.drawImage(a,0,0,n.width,n.height),s.strokeStyle="#39d0d8",s.lineWidth=2,s.setLineDash([5,5]),t.split("\\n").forEach((t,a)=>{if(t.match(/\$[\d,]+|\d+\.?\d*%|\d{1,2}\/\d{1,2}\/\d{4}/)){let i=Math.min(8*t.length*e,n.width-20);s.strokeRect(10,(a+1)*20*r-15,i,18)}})},a.src=e},v=()=>{switch(r.status){case"complete":return"#4CAF50";case"error":return"#f44336";case"processing":return"#ff9800";case"uploading":return"#2196f3";default:return"#666"}};return(0,s.jsxs)("div",{style:{border:"2px dashed #2a3b55",borderRadius:"8px",padding:"20px",margin:"16px 0",background:"var(--panel)"},children:[(0,s.jsx)("h3",{children:"\uD83D\uDD0D Sophisticated OCR Image Processor"}),(0,s.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,s.jsx)("input",{ref:h,type:"file",accept:"image/*",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];return s?["image/jpeg","image/jpg","image/png","image/gif","image/bmp","image/webp"].includes(s.type)?s.size>0xa00000?void n("File too large. Maximum size is 10MB."):void p(s):void n("Please upload an image file (JPEG, PNG, GIF, BMP, or WebP)."):void 0},style:{display:"none"}}),(0,s.jsx)("button",{onClick:()=>{var e;return null==(e=h.current)?void 0:e.click()},disabled:"processing"===r.status||"uploading"===r.status,style:{padding:"12px 24px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"8px",cursor:"processing"===r.status?"not-allowed":"pointer",fontSize:"16px",opacity:"processing"===r.status?.6:1},children:"\uD83D\uDCF7 Select Financial Document Image"}),"idle"!==r.status&&(0,s.jsx)("button",{onClick:()=>{i({status:"idle",progress:0,message:""}),o(null),c(""),m(null),h.current&&(h.current.value="")},style:{padding:"8px 16px",backgroundColor:"#666",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",marginLeft:"12px"},children:"\uD83D\uDD04 Reset"})]}),"idle"!==r.status&&(0,s.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(57, 208, 216, 0.1)",border:"1px solid ".concat(v()),borderRadius:"6px",marginBottom:"16px"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[(0,s.jsx)("span",{style:{fontSize:"18px"},children:(()=>{switch(r.status){case"complete":return"✅";case"error":return"❌";case"processing":return"⚙️";case"uploading":return"\uD83D\uDCE4";default:return"\uD83D\uDCC4"}})()}),(0,s.jsx)("span",{style:{fontWeight:"bold",color:v()},children:r.message})]}),"processing"===r.status&&(0,s.jsx)("div",{style:{width:"100%",height:"8px",backgroundColor:"#334155",borderRadius:"4px",overflow:"hidden"},children:(0,s.jsx)("div",{style:{width:"".concat(r.progress,"%"),height:"100%",backgroundColor:v(),transition:"width 0.3s ease"}})})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[l&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{children:"\uD83D\uDCF7 Uploaded Image"}),(0,s.jsxs)("div",{style:{position:"relative"},children:[(0,s.jsx)("img",{src:l,alt:"Uploaded document",style:{maxWidth:"100%",maxHeight:"300px",border:"1px solid #334155",borderRadius:"8px"}}),"complete"===r.status&&(0,s.jsx)("canvas",{ref:g,style:{position:"absolute",top:0,left:0,maxWidth:"100%",maxHeight:"300px",pointerEvents:"none"}})]})]}),d&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{children:"\uD83D\uDCDD Extracted Text"}),(0,s.jsx)("div",{style:{backgroundColor:"var(--ink)",border:"1px solid #334155",borderRadius:"8px",padding:"12px",maxHeight:"300px",overflowY:"auto",fontSize:"12px",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:d})]})]}),u&&(0,s.jsxs)("div",{style:{marginTop:"16px"},children:[(0,s.jsx)("h4",{children:"\uD83D\uDCCA Extracted Financial Data"}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[u.founders&&u.founders.length>0&&(0,s.jsxs)("div",{style:{backgroundColor:"rgba(53, 199, 89, 0.1)",border:"1px solid #35c759",borderRadius:"6px",padding:"10px"},children:[(0,s.jsxs)("strong",{children:["\uD83D\uDC65 Founders (",u.founders.length,")"]}),u.founders.map((e,t)=>{var n;return(0,s.jsxs)("div",{style:{fontSize:"12px",marginTop:"4px"},children:[e.name||"Unnamed",": $",null==(n=e.amount)?void 0:n.toLocaleString()," (",e.date,")"]},t)})]}),u.investors&&u.investors.length>0&&(0,s.jsxs)("div",{style:{backgroundColor:"rgba(57, 208, 216, 0.1)",border:"1px solid #39d0d8",borderRadius:"6px",padding:"10px"},children:[(0,s.jsxs)("strong",{children:["\uD83D\uDCBC Investors (",u.investors.length,")"]}),u.investors.map((e,t)=>{var n;return(0,s.jsxs)("div",{style:{fontSize:"12px",marginTop:"4px"},children:[e.name||"Unnamed",": $",null==(n=e.amount)?void 0:n.toLocaleString()," (",e.date,")"]},t)})]}),u.settings&&Object.keys(u.settings).length>0&&(0,s.jsxs)("div",{style:{backgroundColor:"rgba(255, 176, 32, 0.1)",border:"1px solid #ffb020",borderRadius:"6px",padding:"10px"},children:[(0,s.jsx)("strong",{children:"⚙️ Settings"}),Object.entries(u.settings).map(e=>{let[t,n]=e;return(0,s.jsxs)("div",{style:{fontSize:"12px",marginTop:"4px"},children:[t,": ","number"==typeof n&&t.includes("Pct")?"".concat(n,"%"):"number"==typeof n?"$".concat(n.toLocaleString()):String(n)]},t)})]})]})]}),(0,s.jsx)("div",{style:{marginTop:"16px",fontSize:"12px",color:"#9aa4b2",fontStyle:"italic"},children:"\uD83D\uDCA1 Upload screenshots or photos of financial documents, spreadsheets, or statements. The OCR will extract amounts, dates, names, and percentages automatically."}),(0,s.jsx)(T,{onTestImage:x})]})}function R(){let[e,t]=(0,a.useState)([{id:"welcome",role:"assistant",content:"Hello! I'm your AI assistant for Founders Fund calculations. I can help you:\n\n• Analyze financial documents with OCR\n• Auto-populate contribution tables\n• Provide investment insights and predictions\n• Validate data and suggest optimizations\n\nHow can I assist you today?",timestamp:new Date}]),[n,r]=(0,a.useState)(""),[i,o]=(0,a.useState)(!1),d=(0,a.useRef)(null),c=l();(0,a.useEffect)(()=>{var e;null==(e=d.current)||e.scrollIntoView({behavior:"smooth"})},[e]);let u=(e,n)=>{let s={id:Date.now().toString(),role:e,content:n,timestamp:new Date};t(e=>[...e,s])},m=async(e,t)=>{try{let s=await fetch("/api/ai/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,context:t||"financial_document",current_settings:{walletSize:c.walletSize,realizedProfit:c.realizedProfit,mgmtFeePct:c.mgmtFeePct,entryFeePct:c.entryFeePct}})});if(!s.ok){var n;if(null==(n=(await s.json().catch(()=>({}))).error)?void 0:n.includes("API key not configured"))return"\uD83D\uDD27 **AI Demo Mode**\n\nAI features require an OpenAI API key. You can still:\n\n• Use the \uD83E\uDD16 AI Populate demo buttons\n• Upload documents for OCR text extraction\n• Test all calculator features\n\nTo enable full AI features, add OPENAI_API_KEY to your .env.local file.";throw Error("AI analysis failed: ".concat(s.statusText))}return(await s.json()).analysis||"Analysis completed"}catch(e){if(e instanceof Error&&e.message.includes("fetch"))return"\uD83D\uDD27 **Connection Issue**\n\nCouldn't connect to AI service. Please check your internet connection and try again.";throw e}},h=async()=>{if(!n.trim()||i)return;let e=n.trim();r(""),u("user",e),o(!0);try{let t=await m(e,"user_query");u("assistant",t)}catch(e){u("assistant","❌ Error: ".concat(e instanceof Error?e.message:"Failed to process your request"))}finally{o(!1)}},g=async()=>{o(!0),u("user","\uD83D\uDCCA Generate investment prediction");try{let e=await m("","prediction_analysis");u("assistant","\uD83D\uDCC8 **Investment Prediction:**\n".concat(e))}catch(e){u("assistant","❌ Prediction error: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{o(!1)}},p=async()=>{o(!0),u("user","\uD83D\uDD0D Validate current data");try{let e=await m("","data_validation");u("assistant","✅ **Data Validation:**\n".concat(e))}catch(e){u("assistant","❌ Validation error: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{o(!1)}};return(0,s.jsxs)("div",{className:"panel",style:{height:"600px",display:"flex",flexDirection:"column"},children:[(0,s.jsx)("h2",{children:"AI Assistant"}),(0,s.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"16px",flexWrap:"wrap"},children:[(0,s.jsx)("button",{onClick:g,disabled:i,style:{padding:"6px 12px",fontSize:"12px"},children:"\uD83D\uDCCA Generate Prediction"}),(0,s.jsx)("button",{onClick:p,disabled:i,style:{padding:"6px 12px",fontSize:"12px"},children:"\uD83D\uDD0D Validate Data"})]}),(0,s.jsx)(k,{onOCRComplete:e=>{if(u("assistant","\uD83C\uDFAF OCR Processing Complete! Extracted financial data from your image."),e.founders&&e.founders.length>0&&window.populateFoundersFromAI&&(window.populateFoundersFromAI(e.founders),u("assistant","✅ Auto-populated ".concat(e.founders.length," founder entries!"))),e.investors&&e.investors.length>0&&window.populateInvestorsFromAI&&(window.populateInvestorsFromAI(e.investors),u("assistant","✅ Auto-populated ".concat(e.investors.length," investor entries!"))),e.settings){e.settings.walletSize&&e.settings.walletSize>0&&c.setWalletSize(Math.round(e.settings.walletSize)),e.settings.realizedProfit&&e.settings.realizedProfit>0&&c.setRealizedProfit(Math.round(e.settings.realizedProfit)),e.settings.unrealizedProfit&&e.settings.unrealizedProfit>0&&(c.setMoonbagUnreal(Math.round(e.settings.unrealizedProfit)),c.setIncludeUnreal("yes")),e.settings.moonbagUnreal&&e.settings.moonbagUnreal>0&&(c.setMoonbagUnreal(Math.round(e.settings.moonbagUnreal)),c.setIncludeUnreal("yes")),e.settings.moonbagFounderPct&&e.settings.moonbagFounderPct>=0&&e.settings.moonbagFounderPct<=100&&c.setMoonbagFounderPct(e.settings.moonbagFounderPct),e.settings.mgmtFeePct&&e.settings.mgmtFeePct>=0&&e.settings.mgmtFeePct<=100&&c.setMgmtFeePct(e.settings.mgmtFeePct),e.settings.entryFeePct&&e.settings.entryFeePct>=0&&e.settings.entryFeePct<=100&&c.setEntryFeePct(e.settings.entryFeePct);let t="⚙️ **Calculator Settings Updated:**\n\n";if(e.settings.walletSize&&(t+="\uD83D\uDCB0 **Wallet Size:** $".concat(Math.round(e.settings.walletSize).toLocaleString(),"\n")),e.settings.realizedProfit&&(t+="\uD83D\uDCC8 **Realized Profit:** $".concat(Math.round(e.settings.realizedProfit).toLocaleString(),"\n")),e.settings.unrealizedProfit||e.settings.moonbagUnreal){let n=e.settings.unrealizedProfit||e.settings.moonbagUnreal||0;t+="\uD83C\uDF19 **Unrealized Profit (Moonbag):** $".concat(Math.round(n).toLocaleString(),"\n"),t+="   • 75% to founders: $".concat(Math.round(.75*n).toLocaleString(),"\n"),t+="   • 25% to investors (time-weighted): $".concat(Math.round(.25*n).toLocaleString(),"\n")}if((e.settings.mgmtFeePct||e.settings.entryFeePct)&&(t+="\uD83D\uDCBC **Fee Structure:**\n",e.settings.mgmtFeePct&&(t+="   • Management Fee: ".concat(e.settings.mgmtFeePct,"% (investors pay → founders receive)\n")),e.settings.entryFeePct&&(t+="   • Entry Fee: ".concat(e.settings.entryFeePct,"% (investors pay → founders receive)\n"))),e.settings.transactionStats){let n=e.settings.transactionStats;t+="\uD83D\uDCCA **Trading Performance:** ".concat(n.winning,"W/").concat(n.losing,"L (").concat(n.winRate.toFixed(1),"% win rate)\n")}u("assistant",t)}u("assistant","\uD83D\uDE80 **All Done!** Your financial document has been processed and the data has been automatically populated into the calculator tables. Check the main Calculator tab to see the results.")},onError:e=>{u("assistant","❌ OCR Error: ".concat(e))}}),(0,s.jsxs)("div",{style:{flex:1,overflowY:"auto",border:"1px solid #ddd",borderRadius:"4px",padding:"12px",marginBottom:"12px",backgroundColor:"#fafafa"},children:[e.map(e=>(0,s.jsxs)("div",{style:{marginBottom:"12px",padding:"8px",borderRadius:"6px",backgroundColor:"user"===e.role?"#e3f2fd":"#f5f5f5",border:"user"===e.role?"1px solid #2196f3":"1px solid #ccc"},children:[(0,s.jsxs)("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px",fontWeight:"bold"},children:["user"===e.role?"\uD83D\uDC64 You":"\uD83E\uDD16 AI Assistant",(0,s.jsx)("span",{style:{float:"right",fontWeight:"normal"},children:e.timestamp.toLocaleTimeString()})]}),(0,s.jsx)("div",{style:{whiteSpace:"pre-line",fontSize:"13px"},children:e.content})]},e.id)),i&&(0,s.jsx)("div",{style:{padding:"8px",fontStyle:"italic",color:"#666",textAlign:"center"},children:"\uD83E\uDD16 AI is thinking..."}),(0,s.jsx)("div",{ref:d})]}),(0,s.jsx)(C,{}),(0,s.jsx)(F,{}),(0,s.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,s.jsx)("textarea",{value:n,onChange:e=>r(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h())},placeholder:"Ask me anything about your fund calculations...",disabled:i,style:{flex:1,minHeight:"40px",maxHeight:"100px",resize:"vertical",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}}),(0,s.jsx)("button",{onClick:h,disabled:!n.trim()||i,style:{padding:"8px 16px",backgroundColor:n.trim()&&!i?"#2196f3":"#ccc",color:"white",border:"none",borderRadius:"4px",cursor:n.trim()&&!i?"pointer":"not-allowed"},children:"Send"})]})]})}function E(){let[e,t]=(0,a.useState)([]),[r,i]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),c=l(),u=async()=>{try{let{jsPDF:e}=await Promise.all([n.e(33),n.e(930),n.e(241)]).then(n.bind(n,5172)),{default:t}=await n.e(941).then(n.bind(n,6941)),s=new e;s.setFontSize(18),s.text("Founders Fund Calculator Report",20,20),s.setFontSize(12),s.text("Generated: ".concat(new Date().toLocaleString()),20,35);let a=[["View Mode",c.view],["Window Start",c.winStart||"Not set"],["Window End",c.winEnd||"Not set"],["Total Wallet Size","$".concat(c.walletSize.toLocaleString())],["Realized Profit","$".concat(c.realizedProfit.toLocaleString())],["Moonbag Real","$".concat(c.moonbagReal.toLocaleString())],["Moonbag Unrealized","$".concat(c.moonbagUnreal.toLocaleString())],["Management Fee","".concat(c.mgmtFeePct,"%")],["Entry Fee","".concat(c.entryFeePct,"%")],["Founder Count",c.founderCount.toString()]];t(s,{head:[["Setting","Value"]],body:a,startY:45,theme:"grid",headStyles:{fillColor:[41,128,185]},styles:{fontSize:10}}),s.save("founders-fund-report-".concat(new Date().toISOString().split("T")[0],".pdf")),d("✅ PDF report generated"),setTimeout(()=>d(""),3e3)}catch(e){d("❌ Error generating PDF"),setTimeout(()=>d(""),3e3)}};return a.useEffect(()=>{let e=localStorage.getItem("foundersFundSnapshots");if(e)try{t(JSON.parse(e))}catch(e){console.warn("Failed to load snapshots from localStorage")}},[]),(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"\uD83D\uDCE6 Export & Import"}),o&&(0,s.jsx)("div",{style:{padding:"8px 12px",backgroundColor:o.includes("❌")?"#ffebee":"#e8f5e8",color:o.includes("❌")?"#c62828":"#2e7d32",borderRadius:"4px",marginBottom:"16px",fontSize:"14px"},children:o}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"\uD83D\uDCF8 Snapshots"}),(0,s.jsx)("button",{onClick:()=>{let n={timestamp:new Date().toISOString(),settings:{view:c.view,winStart:c.winStart,winEnd:c.winEnd,walletSize:c.walletSize,realizedProfit:c.realizedProfit,moonbagReal:c.moonbagReal,moonbagUnreal:c.moonbagUnreal,includeUnreal:c.includeUnreal,moonbagFounderPct:c.moonbagFounderPct,mgmtFeePct:c.mgmtFeePct,entryFeePct:c.entryFeePct,feeReducesInvestor:c.feeReducesInvestor,founderCount:c.founderCount,drawPerFounder:c.drawPerFounder,applyDraws:c.applyDraws,domLeadPct:c.domLeadPct}},s=[...e,n];t(s),localStorage.setItem("foundersFundSnapshots",JSON.stringify(s)),d("✅ Snapshot created at ".concat(new Date(n.timestamp).toLocaleString())),setTimeout(()=>d(""),3e3)},className:"btn",style:{marginBottom:"12px",backgroundColor:"#4CAF50",color:"white"},children:"Create Snapshot"}),(0,s.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto",border:"1px solid #ddd",borderRadius:"4px"},children:0===e.length?(0,s.jsx)("div",{style:{padding:"12px",textAlign:"center",color:"#666"},children:"No snapshots yet. Create one to save current state."}):e.map((n,a)=>(0,s.jsxs)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontSize:"13px",fontWeight:"bold"},children:new Date(n.timestamp).toLocaleString()}),(0,s.jsxs)("div",{style:{fontSize:"11px",color:"#666"},children:["Wallet: $",n.settings.walletSize.toLocaleString()," | Fees: ",n.settings.mgmtFeePct,"%/",n.settings.entryFeePct,"%"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{onClick:()=>(e=>{let t=e.settings;c.setView(t.view),c.setWinStart(t.winStart),c.setWinEnd(t.winEnd),c.setWalletSize(t.walletSize),c.setRealizedProfit(t.realizedProfit),c.setMoonbagReal(t.moonbagReal),c.setMoonbagUnreal(t.moonbagUnreal),c.setIncludeUnreal(t.includeUnreal),c.setMoonbagFounderPct(t.moonbagFounderPct),c.setMgmtFeePct(t.mgmtFeePct),c.setEntryFeePct(t.entryFeePct),c.setFeeReducesInvestor(t.feeReducesInvestor),c.setFounderCount(t.founderCount),c.setDrawPerFounder(t.drawPerFounder),c.setApplyDraws(t.applyDraws),c.setDomLeadPct(t.domLeadPct),d("✅ Loaded snapshot from ".concat(new Date(e.timestamp).toLocaleString())),setTimeout(()=>d(""),3e3)})(n),style:{marginRight:"4px",padding:"2px 6px",fontSize:"11px"},className:"btn",children:"Load"}),(0,s.jsx)("button",{onClick:()=>(n=>{let s=e.filter((e,t)=>t!==n);t(s),localStorage.setItem("foundersFundSnapshots",JSON.stringify(s)),d("✅ Snapshot deleted"),setTimeout(()=>d(""),3e3)})(a),style:{padding:"2px 6px",fontSize:"11px",backgroundColor:"#f44336",color:"white"},className:"btn",children:"Delete"})]})]},a))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"\uD83D\uDCE4 Export"}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,s.jsx)("button",{onClick:()=>{let t=new Blob([JSON.stringify({version:"1.0",exportTime:new Date().toISOString(),snapshots:e},null,2)],{type:"application/json"}),n=URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.download="founders-fund-export-".concat(new Date().toISOString().split("T")[0],".json"),s.click(),URL.revokeObjectURL(n),d("✅ Data exported to JSON file"),setTimeout(()=>d(""),3e3)},className:"btn",style:{backgroundColor:"#2196F3",color:"white"},children:"\uD83D\uDCBE Export to JSON"}),(0,s.jsx)("button",{onClick:u,className:"btn",style:{backgroundColor:"#FF9800",color:"white"},children:"\uD83D\uDCC4 Generate PDF Report"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"\uD83D\uDCE5 Import"}),(0,s.jsx)("textarea",{value:r,onChange:e=>i(e.target.value),placeholder:"Paste JSON data here...",style:{width:"100%",height:"120px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"}}),(0,s.jsx)("button",{onClick:()=>{try{let e=JSON.parse(r);e.snapshots&&Array.isArray(e.snapshots)?(t(e.snapshots),localStorage.setItem("foundersFundSnapshots",JSON.stringify(e.snapshots)),d("✅ Imported ".concat(e.snapshots.length," snapshots")),i("")):d("❌ Invalid JSON format")}catch(e){d("❌ Error parsing JSON")}setTimeout(()=>d(""),3e3)},className:"btn",style:{marginTop:"8px",backgroundColor:"#9C27B0",color:"white"},disabled:!r.trim(),children:"\uD83D\uDCE5 Import from JSON"})]})]}),(0,s.jsx)("div",{style:{marginTop:"16px",fontSize:"12px",color:"#666",fontStyle:"italic"},children:"\uD83D\uDCA1 Snapshots are automatically saved to browser storage. Use export/import for backup or sharing between devices."})]})}function I(){return(0,s.jsx)(E,{})}function _(){let[e,t]=(0,a.useState)("current"),[n,r]=(0,a.useState)("lineNet"),[i,o]=(0,a.useState)("yes"),d=(0,a.useRef)(null),c=l(),u=()=>{let t,s,a,r=d.current;if(!r)return;let i=r.getContext("2d");if(!i)return;i.clearRect(0,0,r.width,r.height);let{labels:l,netProfits:o,baseProfits:c,endCapital:u}={labels:["Laura (7/22)","Laura (7/31)","Laura (8/25)","Laura (9/6)","Damon (8/2)"],netProfits:[4500,4500,2250,2250,4500],baseProfits:[5e3,5e3,2500,2500,5e3],endCapital:[4500,9e3,11250,13500,18e3]},m=r.width-120,h=r.height-120;switch(n){case"lineNet":case"barNet":default:t=o,s="Net Profit by Contributor",a="Net Profit ($)";break;case"barBase":t=c,s="Base Contribution by Contributor",a="Base Amount ($)";break;case"lineEnd":t=u,s="Cumulative Capital by Contributor",a="End Capital ($)"}let g=Math.max(...t),p=Math.min(...t),x=g-p||1;if(i.strokeStyle="#333",i.lineWidth=1,i.beginPath(),i.moveTo(60,60),i.lineTo(60,r.height-60),i.lineTo(r.width-60,r.height-60),i.stroke(),n.startsWith("bar")){let e=m/l.length*.6,n=m/l.length;i.fillStyle="#4CAF50",t.forEach((t,s)=>{let a=t/g*h,l=60+s*n+(n-e)/2,o=r.height-60-a;i.fillRect(l,o,e,a),i.fillStyle="#333",i.font="11px Arial",i.textAlign="center",i.fillText("$".concat(t.toLocaleString()),l+e/2,o-5),i.fillStyle="#4CAF50"})}else i.strokeStyle="#2196F3",i.lineWidth=2,i.beginPath(),t.forEach((e,t)=>{let n=60+t*m/(l.length-1),s=r.height-60-(e-p)/x*h;0===t?i.moveTo(n,s):i.lineTo(n,s),i.fillStyle="#2196F3",i.beginPath(),i.arc(n,s,4,0,2*Math.PI),i.fill()}),i.stroke();i.fillStyle="#333",i.font="11px Arial",i.textAlign="center",l.forEach((e,t)=>{let n=60+t*m/(l.length-1),s=r.height-60+20;i.save(),i.translate(n,s),i.rotate(-Math.PI/6),i.fillText(e,0,0),i.restore()}),i.textAlign="right";for(let e=0;e<=5;e++){let t=p+x*e/5,n=r.height-60-e*h/5;i.fillText("$".concat(Math.round(t).toLocaleString()),50,n+3)}i.font="bold 14px Arial",i.textAlign="center",i.fillText(s,r.width/2,25);let f=document.getElementById("legend"),v=document.getElementById("yAxisTitle"),y=document.getElementById("xAxisTitle"),j=document.getElementById("chartNote");f&&(f.innerHTML='\n        <div style="display: flex; justify-content: center; gap: 20px; margin-top: 10px;">\n          <div style="display: flex; align-items: center; gap: 5px;">\n            <div style="width: 20px; height: 3px; background: '.concat(n.startsWith("bar")?"#4CAF50":"#2196F3",';"></div>\n            <span style="font-size: 12px;">').concat(s,"</span>\n          </div>\n        </div>\n      ")),v&&(v.textContent=a),y&&(y.textContent="Contributors"),j&&(j.textContent="Data source: ".concat("current"===e?"Current calculator state":"Saved snapshots"," | ").concat(l.length," data points"))};return(0,a.useEffect)(()=>{let e=setTimeout(()=>{u()},100);return()=>clearTimeout(e)},[n,e,i,c.walletSize,c.realizedProfit]),(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"Charts"}),(0,s.jsxs)("div",{className:"grid",style:{alignItems:"center"},children:[(0,s.jsxs)("div",{style:{gridColumn:"span 4"},children:[(0,s.jsx)("label",{children:"Data Source"}),(0,s.jsxs)("select",{value:e,onChange:e=>t(e.target.value),children:[(0,s.jsx)("option",{value:"current",children:"Current (on screen)"}),(0,s.jsx)("option",{value:"latest",children:"Latest saved snapshot"}),(0,s.jsx)("option",{value:"all",children:"All saved snapshots (time series)"})]})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 5"},children:[(0,s.jsx)("label",{children:"Chart Type"}),(0,s.jsxs)("select",{value:n,onChange:e=>r(e.target.value),children:[(0,s.jsx)("option",{value:"lineNet",children:"Line — Net profit (per class)"}),(0,s.jsx)("option",{value:"barNet",children:"Bar — Net profit (per class)"}),(0,s.jsx)("option",{value:"barBase",children:"Bar — Base profit (per class)"}),(0,s.jsx)("option",{value:"lineEnd",children:"Line — End capital (per class)"}),(0,s.jsx)("option",{value:"linePGP",children:"Line — PGP (period %, time-weighted)"})]})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 2"},children:[(0,s.jsx)("label",{children:"Include Founders in line charts?"}),(0,s.jsxs)("select",{value:i,onChange:e=>o(e.target.value),children:[(0,s.jsx)("option",{value:"yes",children:"Yes"}),(0,s.jsx)("option",{value:"no",children:"No"})]})]}),(0,s.jsxs)("div",{style:{gridColumn:"span 1"},children:[(0,s.jsx)("label",{children:"\xa0"}),(0,s.jsx)("button",{className:"btn",onClick:()=>{u()},children:"Draw"})]})]}),(0,s.jsxs)("div",{style:{marginTop:"12px"},children:[(0,s.jsx)("canvas",{ref:d,id:"chart",width:1100,height:420}),(0,s.jsx)("div",{className:"legend",id:"legend"}),(0,s.jsx)("div",{className:"small",id:"chartNote"}),(0,s.jsxs)("div",{className:"small",style:{marginTop:"6px"},children:[(0,s.jsx)("b",{id:"yAxisTitle"})," — Y-axis \xb7 ",(0,s.jsx)("b",{id:"xAxisTitle"})," — X-axis"]})]})]})}function A(){return(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsx)("h2",{children:"Founders Audit — Composition & Math"}),(0,s.jsx)("div",{className:"small muted",children:"Founders audit placeholder"})]})}function L(){let[e,t]=(0,a.useState)("calc");return(0,s.jsx)(i,{children:(0,s.jsxs)("div",{className:"wrap",children:[(0,s.jsx)(d,{}),(0,s.jsx)("h1",{children:"Founders Fund"}),(0,s.jsx)(u,{active:e,onChange:t}),"calc"===e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h,{}),(0,s.jsx)(p,{}),(0,s.jsx)(w,{}),(0,s.jsx)(S,{})]}),"history"===e&&(0,s.jsx)(I,{}),"charts"===e&&(0,s.jsx)(_,{}),"audit"===e&&(0,s.jsx)(A,{}),"assistant"===e&&(0,s.jsx)(R,{})]})})}}},e=>{e.O(0,[511,441,255,358],()=>e(e.s=600)),_N_E=e.O()}]);